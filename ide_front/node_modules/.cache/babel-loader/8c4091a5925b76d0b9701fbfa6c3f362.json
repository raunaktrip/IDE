{"ast":null,"code":"ace.define(\"ace/snippets\", [\"require\", \"exports\", \"module\", \"ace/lib/dom\", \"ace/lib/oop\", \"ace/lib/event_emitter\", \"ace/lib/lang\", \"ace/range\", \"ace/range_list\", \"ace/keyboard/hash_handler\", \"ace/tokenizer\", \"ace/clipboard\", \"ace/editor\"], function (require, exports, module) {\n  \"use strict\";\n\n  var dom = require(\"./lib/dom\");\n\n  var oop = require(\"./lib/oop\");\n\n  var EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\n\n  var lang = require(\"./lib/lang\");\n\n  var Range = require(\"./range\").Range;\n\n  var RangeList = require(\"./range_list\").RangeList;\n\n  var HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\n\n  var Tokenizer = require(\"./tokenizer\").Tokenizer;\n\n  var clipboard = require(\"./clipboard\");\n\n  var VARIABLES = {\n    CURRENT_WORD: function (editor) {\n      return editor.session.getTextRange(editor.session.getWordRange());\n    },\n    SELECTION: function (editor, name, indentation) {\n      var text = editor.session.getTextRange();\n      if (indentation) return text.replace(/\\n\\r?([ \\t]*\\S)/g, \"\\n\" + indentation + \"$1\");\n      return text;\n    },\n    CURRENT_LINE: function (editor) {\n      return editor.session.getLine(editor.getCursorPosition().row);\n    },\n    PREV_LINE: function (editor) {\n      return editor.session.getLine(editor.getCursorPosition().row - 1);\n    },\n    LINE_INDEX: function (editor) {\n      return editor.getCursorPosition().row;\n    },\n    LINE_NUMBER: function (editor) {\n      return editor.getCursorPosition().row + 1;\n    },\n    SOFT_TABS: function (editor) {\n      return editor.session.getUseSoftTabs() ? \"YES\" : \"NO\";\n    },\n    TAB_SIZE: function (editor) {\n      return editor.session.getTabSize();\n    },\n    CLIPBOARD: function (editor) {\n      return clipboard.getText && clipboard.getText();\n    },\n    FILENAME: function (editor) {\n      return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0];\n    },\n    FILENAME_BASE: function (editor) {\n      return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0].replace(/\\.[^.]*$/, \"\");\n    },\n    DIRECTORY: function (editor) {\n      return this.FILEPATH(editor).replace(/[^/\\\\]*$/, \"\");\n    },\n    FILEPATH: function (editor) {\n      return \"/not implemented.txt\";\n    },\n    WORKSPACE_NAME: function () {\n      return \"Unknown\";\n    },\n    FULLNAME: function () {\n      return \"Unknown\";\n    },\n    BLOCK_COMMENT_START: function (editor) {\n      var mode = editor.session.$mode || {};\n      return mode.blockComment && mode.blockComment.start || \"\";\n    },\n    BLOCK_COMMENT_END: function (editor) {\n      var mode = editor.session.$mode || {};\n      return mode.blockComment && mode.blockComment.end || \"\";\n    },\n    LINE_COMMENT: function (editor) {\n      var mode = editor.session.$mode || {};\n      return mode.lineCommentStart || \"\";\n    },\n    CURRENT_YEAR: date.bind(null, {\n      year: \"numeric\"\n    }),\n    CURRENT_YEAR_SHORT: date.bind(null, {\n      year: \"2-digit\"\n    }),\n    CURRENT_MONTH: date.bind(null, {\n      month: \"numeric\"\n    }),\n    CURRENT_MONTH_NAME: date.bind(null, {\n      month: \"long\"\n    }),\n    CURRENT_MONTH_NAME_SHORT: date.bind(null, {\n      month: \"short\"\n    }),\n    CURRENT_DATE: date.bind(null, {\n      day: \"2-digit\"\n    }),\n    CURRENT_DAY_NAME: date.bind(null, {\n      weekday: \"long\"\n    }),\n    CURRENT_DAY_NAME_SHORT: date.bind(null, {\n      weekday: \"short\"\n    }),\n    CURRENT_HOUR: date.bind(null, {\n      hour: \"2-digit\",\n      hour12: false\n    }),\n    CURRENT_MINUTE: date.bind(null, {\n      minute: \"2-digit\"\n    }),\n    CURRENT_SECOND: date.bind(null, {\n      second: \"2-digit\"\n    })\n  };\n  VARIABLES.SELECTED_TEXT = VARIABLES.SELECTION;\n\n  function date(dateFormat) {\n    var str = new Date().toLocaleString(\"en-us\", dateFormat);\n    return str.length == 1 ? \"0\" + str : str;\n  }\n\n  var SnippetManager = function () {\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n  };\n\n  (function () {\n    oop.implement(this, EventEmitter);\n\n    this.getTokenizer = function () {\n      return SnippetManager.$tokenizer || this.createTokenizer();\n    };\n\n    this.createTokenizer = function () {\n      function TabstopToken(str) {\n        str = str.substr(1);\n        if (/^\\d+$/.test(str)) return [{\n          tabstopId: parseInt(str, 10)\n        }];\n        return [{\n          text: str\n        }];\n      }\n\n      function escape(ch) {\n        return \"(?:[^\\\\\\\\\" + ch + \"]|\\\\\\\\.)\";\n      }\n\n      var formatMatcher = {\n        regex: \"/(\" + escape(\"/\") + \"+)/\",\n        onMatch: function (val, state, stack) {\n          var ts = stack[0];\n          ts.fmtString = true;\n          ts.guard = val.slice(1, -1);\n          ts.flag = \"\";\n          return \"\";\n        },\n        next: \"formatString\"\n      };\n      SnippetManager.$tokenizer = new Tokenizer({\n        start: [{\n          regex: /\\\\./,\n          onMatch: function (val, state, stack) {\n            var ch = val[1];\n\n            if (ch == \"}\" && stack.length) {\n              val = ch;\n            } else if (\"`$\\\\\".indexOf(ch) != -1) {\n              val = ch;\n            }\n\n            return [val];\n          }\n        }, {\n          regex: /}/,\n          onMatch: function (val, state, stack) {\n            return [stack.length ? stack.shift() : val];\n          }\n        }, {\n          regex: /\\$(?:\\d+|\\w+)/,\n          onMatch: TabstopToken\n        }, {\n          regex: /\\$\\{[\\dA-Z_a-z]+/,\n          onMatch: function (str, state, stack) {\n            var t = TabstopToken(str.substr(1));\n            stack.unshift(t[0]);\n            return t;\n          },\n          next: \"snippetVar\"\n        }, {\n          regex: /\\n/,\n          token: \"newline\",\n          merge: false\n        }],\n        snippetVar: [{\n          regex: \"\\\\|\" + escape(\"\\\\|\") + \"*\\\\|\",\n          onMatch: function (val, state, stack) {\n            var choices = val.slice(1, -1).replace(/\\\\[,|\\\\]|,/g, function (operator) {\n              return operator.length == 2 ? operator[1] : \"\\x00\";\n            }).split(\"\\x00\").map(function (value) {\n              return {\n                value: value\n              };\n            });\n            stack[0].choices = choices;\n            return [choices[0]];\n          },\n          next: \"start\"\n        }, formatMatcher, {\n          regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\",\n          token: \"\",\n          next: \"start\"\n        }],\n        formatString: [{\n          regex: /:/,\n          onMatch: function (val, state, stack) {\n            if (stack.length && stack[0].expectElse) {\n              stack[0].expectElse = false;\n              stack[0].ifEnd = {\n                elseEnd: stack[0]\n              };\n              return [stack[0].ifEnd];\n            }\n\n            return \":\";\n          }\n        }, {\n          regex: /\\\\./,\n          onMatch: function (val, state, stack) {\n            var ch = val[1];\n            if (ch == \"}\" && stack.length) val = ch;else if (\"`$\\\\\".indexOf(ch) != -1) val = ch;else if (ch == \"n\") val = \"\\n\";else if (ch == \"t\") val = \"\\t\";else if (\"ulULE\".indexOf(ch) != -1) val = {\n              changeCase: ch,\n              local: ch > \"a\"\n            };\n            return [val];\n          }\n        }, {\n          regex: \"/\\\\w*}\",\n          onMatch: function (val, state, stack) {\n            var next = stack.shift();\n            if (next) next.flag = val.slice(1, -1);\n            this.next = next && next.tabstopId ? \"start\" : \"\";\n            return [next || val];\n          },\n          next: \"start\"\n        }, {\n          regex: /\\$(?:\\d+|\\w+)/,\n          onMatch: function (val, state, stack) {\n            return [{\n              text: val.slice(1)\n            }];\n          }\n        }, {\n          regex: /\\${\\w+/,\n          onMatch: function (val, state, stack) {\n            var token = {\n              text: val.slice(2)\n            };\n            stack.unshift(token);\n            return [token];\n          },\n          next: \"formatStringVar\"\n        }, {\n          regex: /\\n/,\n          token: \"newline\",\n          merge: false\n        }, {\n          regex: /}/,\n          onMatch: function (val, state, stack) {\n            var next = stack.shift();\n            this.next = next && next.tabstopId ? \"start\" : \"\";\n            return [next || val];\n          },\n          next: \"start\"\n        }],\n        formatStringVar: [{\n          regex: /:\\/\\w+}/,\n          onMatch: function (val, state, stack) {\n            var ts = stack[0];\n            ts.formatFunction = val.slice(2, -1);\n            return [stack.shift()];\n          },\n          next: \"formatString\"\n        }, formatMatcher, {\n          regex: /:[\\?\\-+]?/,\n          onMatch: function (val, state, stack) {\n            if (val[1] == \"+\") stack[0].ifEnd = stack[0];\n            if (val[1] == \"?\") stack[0].expectElse = true;\n          },\n          next: \"formatString\"\n        }, {\n          regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\",\n          token: \"\",\n          next: \"formatString\"\n        }]\n      });\n      return SnippetManager.$tokenizer;\n    };\n\n    this.tokenizeTmSnippet = function (str, startState) {\n      return this.getTokenizer().getLineTokens(str, startState).tokens.map(function (x) {\n        return x.value || x;\n      });\n    };\n\n    this.getVariableValue = function (editor, name, indentation) {\n      if (/^\\d+$/.test(name)) return (this.variables.__ || {})[name] || \"\";\n      if (/^[A-Z]\\d+$/.test(name)) return (this.variables[name[0] + \"__\"] || {})[name.substr(1)] || \"\";\n      name = name.replace(/^TM_/, \"\");\n      if (!this.variables.hasOwnProperty(name)) return \"\";\n      var value = this.variables[name];\n      if (typeof value == \"function\") value = this.variables[name](editor, name, indentation);\n      return value == null ? \"\" : value;\n    };\n\n    this.variables = VARIABLES;\n\n    this.tmStrFormat = function (str, ch, editor) {\n      if (!ch.fmt) return str;\n      var flag = ch.flag || \"\";\n      var re = ch.guard;\n      re = new RegExp(re, flag.replace(/[^gim]/g, \"\"));\n      var fmtTokens = typeof ch.fmt == \"string\" ? this.tokenizeTmSnippet(ch.fmt, \"formatString\") : ch.fmt;\n\n      var _self = this;\n\n      var formatted = str.replace(re, function () {\n        var oldArgs = _self.variables.__;\n        _self.variables.__ = [].slice.call(arguments);\n\n        var fmtParts = _self.resolveVariables(fmtTokens, editor);\n\n        var gChangeCase = \"E\";\n\n        for (var i = 0; i < fmtParts.length; i++) {\n          var ch = fmtParts[i];\n\n          if (typeof ch == \"object\") {\n            fmtParts[i] = \"\";\n\n            if (ch.changeCase && ch.local) {\n              var next = fmtParts[i + 1];\n\n              if (next && typeof next == \"string\") {\n                if (ch.changeCase == \"u\") fmtParts[i] = next[0].toUpperCase();else fmtParts[i] = next[0].toLowerCase();\n                fmtParts[i + 1] = next.substr(1);\n              }\n            } else if (ch.changeCase) {\n              gChangeCase = ch.changeCase;\n            }\n          } else if (gChangeCase == \"U\") {\n            fmtParts[i] = ch.toUpperCase();\n          } else if (gChangeCase == \"L\") {\n            fmtParts[i] = ch.toLowerCase();\n          }\n        }\n\n        _self.variables.__ = oldArgs;\n        return fmtParts.join(\"\");\n      });\n      return formatted;\n    };\n\n    this.tmFormatFunction = function (str, ch, editor) {\n      if (ch.formatFunction == \"upcase\") return str.toUpperCase();\n      if (ch.formatFunction == \"downcase\") return str.toLowerCase();\n      return str;\n    };\n\n    this.resolveVariables = function (snippet, editor) {\n      var result = [];\n      var indentation = \"\";\n      var afterNewLine = true;\n\n      for (var i = 0; i < snippet.length; i++) {\n        var ch = snippet[i];\n\n        if (typeof ch == \"string\") {\n          result.push(ch);\n\n          if (ch == \"\\n\") {\n            afterNewLine = true;\n            indentation = \"\";\n          } else if (afterNewLine) {\n            indentation = /^\\t*/.exec(ch)[0];\n            afterNewLine = /\\S/.test(ch);\n          }\n\n          continue;\n        }\n\n        if (!ch) continue;\n        afterNewLine = false;\n\n        if (ch.fmtString) {\n          var j = snippet.indexOf(ch, i + 1);\n          if (j == -1) j = snippet.length;\n          ch.fmt = snippet.slice(i + 1, j);\n          i = j;\n        }\n\n        if (ch.text) {\n          var value = this.getVariableValue(editor, ch.text, indentation) + \"\";\n          if (ch.fmtString) value = this.tmStrFormat(value, ch, editor);\n          if (ch.formatFunction) value = this.tmFormatFunction(value, ch, editor);\n\n          if (value && !ch.ifEnd) {\n            result.push(value);\n            gotoNext(ch);\n          } else if (!value && ch.ifEnd) {\n            gotoNext(ch.ifEnd);\n          }\n        } else if (ch.elseEnd) {\n          gotoNext(ch.elseEnd);\n        } else if (ch.tabstopId != null) {\n          result.push(ch);\n        } else if (ch.changeCase != null) {\n          result.push(ch);\n        }\n      }\n\n      function gotoNext(ch) {\n        var i1 = snippet.indexOf(ch, i + 1);\n        if (i1 != -1) i = i1;\n      }\n\n      return result;\n    };\n\n    this.insertSnippetForSelection = function (editor, snippetText) {\n      var cursor = editor.getCursorPosition();\n      var line = editor.session.getLine(cursor.row);\n      var tabString = editor.session.getTabString();\n      var indentString = line.match(/^\\s*/)[0];\n      if (cursor.column < indentString.length) indentString = indentString.slice(0, cursor.column);\n      snippetText = snippetText.replace(/\\r/g, \"\");\n      var tokens = this.tokenizeTmSnippet(snippetText);\n      tokens = this.resolveVariables(tokens, editor);\n      tokens = tokens.map(function (x) {\n        if (x == \"\\n\") return x + indentString;\n        if (typeof x == \"string\") return x.replace(/\\t/g, tabString);\n        return x;\n      });\n      var tabstops = [];\n      tokens.forEach(function (p, i) {\n        if (typeof p != \"object\") return;\n        var id = p.tabstopId;\n        var ts = tabstops[id];\n\n        if (!ts) {\n          ts = tabstops[id] = [];\n          ts.index = id;\n          ts.value = \"\";\n          ts.parents = {};\n        }\n\n        if (ts.indexOf(p) !== -1) return;\n        if (p.choices && !ts.choices) ts.choices = p.choices;\n        ts.push(p);\n        var i1 = tokens.indexOf(p, i + 1);\n        if (i1 === -1) return;\n        var value = tokens.slice(i + 1, i1);\n        var isNested = value.some(function (t) {\n          return typeof t === \"object\";\n        });\n\n        if (isNested && !ts.value) {\n          ts.value = value;\n        } else if (value.length && (!ts.value || typeof ts.value !== \"string\")) {\n          ts.value = value.join(\"\");\n        }\n      });\n      tabstops.forEach(function (ts) {\n        ts.length = 0;\n      });\n      var expanding = {};\n\n      function copyValue(val) {\n        var copy = [];\n\n        for (var i = 0; i < val.length; i++) {\n          var p = val[i];\n\n          if (typeof p == \"object\") {\n            if (expanding[p.tabstopId]) continue;\n            var j = val.lastIndexOf(p, i - 1);\n            p = copy[j] || {\n              tabstopId: p.tabstopId\n            };\n          }\n\n          copy[i] = p;\n        }\n\n        return copy;\n      }\n\n      for (var i = 0; i < tokens.length; i++) {\n        var p = tokens[i];\n        if (typeof p != \"object\") continue;\n        var id = p.tabstopId;\n        var ts = tabstops[id];\n        var i1 = tokens.indexOf(p, i + 1);\n\n        if (expanding[id]) {\n          if (expanding[id] === p) {\n            delete expanding[id];\n            Object.keys(expanding).forEach(function (parentId) {\n              ts.parents[parentId] = true;\n            });\n          }\n\n          continue;\n        }\n\n        expanding[id] = p;\n        var value = ts.value;\n        if (typeof value !== \"string\") value = copyValue(value);else if (p.fmt) value = this.tmStrFormat(value, p, editor);\n        tokens.splice.apply(tokens, [i + 1, Math.max(0, i1 - i)].concat(value, p));\n        if (ts.indexOf(p) === -1) ts.push(p);\n      }\n\n      var row = 0,\n          column = 0;\n      var text = \"\";\n      tokens.forEach(function (t) {\n        if (typeof t === \"string\") {\n          var lines = t.split(\"\\n\");\n\n          if (lines.length > 1) {\n            column = lines[lines.length - 1].length;\n            row += lines.length - 1;\n          } else column += t.length;\n\n          text += t;\n        } else if (t) {\n          if (!t.start) t.start = {\n            row: row,\n            column: column\n          };else t.end = {\n            row: row,\n            column: column\n          };\n        }\n      });\n      var range = editor.getSelectionRange();\n      var end = editor.session.replace(range, text);\n      var tabstopManager = new TabstopManager(editor);\n      var selectionId = editor.inVirtualSelectionMode && editor.selection.index;\n      tabstopManager.addTabstops(tabstops, range.start, end, selectionId);\n    };\n\n    this.insertSnippet = function (editor, snippetText) {\n      var self = this;\n      if (editor.inVirtualSelectionMode) return self.insertSnippetForSelection(editor, snippetText);\n      editor.forEachSelection(function () {\n        self.insertSnippetForSelection(editor, snippetText);\n      }, null, {\n        keepOrder: true\n      });\n      if (editor.tabstopManager) editor.tabstopManager.tabNext();\n    };\n\n    this.$getScope = function (editor) {\n      var scope = editor.session.$mode.$id || \"\";\n      scope = scope.split(\"/\").pop();\n\n      if (scope === \"html\" || scope === \"php\") {\n        if (scope === \"php\" && !editor.session.$mode.inlinePhp) scope = \"html\";\n        var c = editor.getCursorPosition();\n        var state = editor.session.getState(c.row);\n\n        if (typeof state === \"object\") {\n          state = state[0];\n        }\n\n        if (state.substring) {\n          if (state.substring(0, 3) == \"js-\") scope = \"javascript\";else if (state.substring(0, 4) == \"css-\") scope = \"css\";else if (state.substring(0, 4) == \"php-\") scope = \"php\";\n        }\n      }\n\n      return scope;\n    };\n\n    this.getActiveScopes = function (editor) {\n      var scope = this.$getScope(editor);\n      var scopes = [scope];\n      var snippetMap = this.snippetMap;\n\n      if (snippetMap[scope] && snippetMap[scope].includeScopes) {\n        scopes.push.apply(scopes, snippetMap[scope].includeScopes);\n      }\n\n      scopes.push(\"_\");\n      return scopes;\n    };\n\n    this.expandWithTab = function (editor, options) {\n      var self = this;\n      var result = editor.forEachSelection(function () {\n        return self.expandSnippetForSelection(editor, options);\n      }, null, {\n        keepOrder: true\n      });\n      if (result && editor.tabstopManager) editor.tabstopManager.tabNext();\n      return result;\n    };\n\n    this.expandSnippetForSelection = function (editor, options) {\n      var cursor = editor.getCursorPosition();\n      var line = editor.session.getLine(cursor.row);\n      var before = line.substring(0, cursor.column);\n      var after = line.substr(cursor.column);\n      var snippetMap = this.snippetMap;\n      var snippet;\n      this.getActiveScopes(editor).some(function (scope) {\n        var snippets = snippetMap[scope];\n        if (snippets) snippet = this.findMatchingSnippet(snippets, before, after);\n        return !!snippet;\n      }, this);\n      if (!snippet) return false;\n      if (options && options.dryRun) return true;\n      editor.session.doc.removeInLine(cursor.row, cursor.column - snippet.replaceBefore.length, cursor.column + snippet.replaceAfter.length);\n      this.variables.M__ = snippet.matchBefore;\n      this.variables.T__ = snippet.matchAfter;\n      this.insertSnippetForSelection(editor, snippet.content);\n      this.variables.M__ = this.variables.T__ = null;\n      return true;\n    };\n\n    this.findMatchingSnippet = function (snippetList, before, after) {\n      for (var i = snippetList.length; i--;) {\n        var s = snippetList[i];\n        if (s.startRe && !s.startRe.test(before)) continue;\n        if (s.endRe && !s.endRe.test(after)) continue;\n        if (!s.startRe && !s.endRe) continue;\n        s.matchBefore = s.startRe ? s.startRe.exec(before) : [\"\"];\n        s.matchAfter = s.endRe ? s.endRe.exec(after) : [\"\"];\n        s.replaceBefore = s.triggerRe ? s.triggerRe.exec(before)[0] : \"\";\n        s.replaceAfter = s.endTriggerRe ? s.endTriggerRe.exec(after)[0] : \"\";\n        return s;\n      }\n    };\n\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n\n    this.register = function (snippets, scope) {\n      var snippetMap = this.snippetMap;\n      var snippetNameMap = this.snippetNameMap;\n      var self = this;\n      if (!snippets) snippets = [];\n\n      function wrapRegexp(src) {\n        if (src && !/^\\^?\\(.*\\)\\$?$|^\\\\b$/.test(src)) src = \"(?:\" + src + \")\";\n        return src || \"\";\n      }\n\n      function guardedRegexp(re, guard, opening) {\n        re = wrapRegexp(re);\n        guard = wrapRegexp(guard);\n\n        if (opening) {\n          re = guard + re;\n          if (re && re[re.length - 1] != \"$\") re = re + \"$\";\n        } else {\n          re = re + guard;\n          if (re && re[0] != \"^\") re = \"^\" + re;\n        }\n\n        return new RegExp(re);\n      }\n\n      function addSnippet(s) {\n        if (!s.scope) s.scope = scope || \"_\";\n        scope = s.scope;\n\n        if (!snippetMap[scope]) {\n          snippetMap[scope] = [];\n          snippetNameMap[scope] = {};\n        }\n\n        var map = snippetNameMap[scope];\n\n        if (s.name) {\n          var old = map[s.name];\n          if (old) self.unregister(old);\n          map[s.name] = s;\n        }\n\n        snippetMap[scope].push(s);\n        if (s.prefix) s.tabTrigger = s.prefix;\n        if (!s.content && s.body) s.content = Array.isArray(s.body) ? s.body.join(\"\\n\") : s.body;\n\n        if (s.tabTrigger && !s.trigger) {\n          if (!s.guard && /^\\w/.test(s.tabTrigger)) s.guard = \"\\\\b\";\n          s.trigger = lang.escapeRegExp(s.tabTrigger);\n        }\n\n        if (!s.trigger && !s.guard && !s.endTrigger && !s.endGuard) return;\n        s.startRe = guardedRegexp(s.trigger, s.guard, true);\n        s.triggerRe = new RegExp(s.trigger);\n        s.endRe = guardedRegexp(s.endTrigger, s.endGuard, true);\n        s.endTriggerRe = new RegExp(s.endTrigger);\n      }\n\n      if (Array.isArray(snippets)) {\n        snippets.forEach(addSnippet);\n      } else {\n        Object.keys(snippets).forEach(function (key) {\n          addSnippet(snippets[key]);\n        });\n      }\n\n      this._signal(\"registerSnippets\", {\n        scope: scope\n      });\n    };\n\n    this.unregister = function (snippets, scope) {\n      var snippetMap = this.snippetMap;\n      var snippetNameMap = this.snippetNameMap;\n\n      function removeSnippet(s) {\n        var nameMap = snippetNameMap[s.scope || scope];\n\n        if (nameMap && nameMap[s.name]) {\n          delete nameMap[s.name];\n          var map = snippetMap[s.scope || scope];\n          var i = map && map.indexOf(s);\n          if (i >= 0) map.splice(i, 1);\n        }\n      }\n\n      if (snippets.content) removeSnippet(snippets);else if (Array.isArray(snippets)) snippets.forEach(removeSnippet);\n    };\n\n    this.parseSnippetFile = function (str) {\n      str = str.replace(/\\r/g, \"\");\n      var list = [],\n          snippet = {};\n      var re = /^#.*|^({[\\s\\S]*})\\s*$|^(\\S+) (.*)$|^((?:\\n*\\t.*)+)/gm;\n      var m;\n\n      while (m = re.exec(str)) {\n        if (m[1]) {\n          try {\n            snippet = JSON.parse(m[1]);\n            list.push(snippet);\n          } catch (e) {}\n        }\n\n        if (m[4]) {\n          snippet.content = m[4].replace(/^\\t/gm, \"\");\n          list.push(snippet);\n          snippet = {};\n        } else {\n          var key = m[2],\n              val = m[3];\n\n          if (key == \"regex\") {\n            var guardRe = /\\/((?:[^\\/\\\\]|\\\\.)*)|$/g;\n            snippet.guard = guardRe.exec(val)[1];\n            snippet.trigger = guardRe.exec(val)[1];\n            snippet.endTrigger = guardRe.exec(val)[1];\n            snippet.endGuard = guardRe.exec(val)[1];\n          } else if (key == \"snippet\") {\n            snippet.tabTrigger = val.match(/^\\S*/)[0];\n            if (!snippet.name) snippet.name = val;\n          } else if (key) {\n            snippet[key] = val;\n          }\n        }\n      }\n\n      return list;\n    };\n\n    this.getSnippetByName = function (name, editor) {\n      var snippetMap = this.snippetNameMap;\n      var snippet;\n      this.getActiveScopes(editor).some(function (scope) {\n        var snippets = snippetMap[scope];\n        if (snippets) snippet = snippets[name];\n        return !!snippet;\n      }, this);\n      return snippet;\n    };\n  }).call(SnippetManager.prototype);\n\n  var TabstopManager = function (editor) {\n    if (editor.tabstopManager) return editor.tabstopManager;\n    editor.tabstopManager = this;\n    this.$onChange = this.onChange.bind(this);\n    this.$onChangeSelection = lang.delayedCall(this.onChangeSelection.bind(this)).schedule;\n    this.$onChangeSession = this.onChangeSession.bind(this);\n    this.$onAfterExec = this.onAfterExec.bind(this);\n    this.attach(editor);\n  };\n\n  (function () {\n    this.attach = function (editor) {\n      this.index = 0;\n      this.ranges = [];\n      this.tabstops = [];\n      this.$openTabstops = null;\n      this.selectedTabstop = null;\n      this.editor = editor;\n      this.editor.on(\"change\", this.$onChange);\n      this.editor.on(\"changeSelection\", this.$onChangeSelection);\n      this.editor.on(\"changeSession\", this.$onChangeSession);\n      this.editor.commands.on(\"afterExec\", this.$onAfterExec);\n      this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n    };\n\n    this.detach = function () {\n      this.tabstops.forEach(this.removeTabstopMarkers, this);\n      this.ranges = null;\n      this.tabstops = null;\n      this.selectedTabstop = null;\n      this.editor.removeListener(\"change\", this.$onChange);\n      this.editor.removeListener(\"changeSelection\", this.$onChangeSelection);\n      this.editor.removeListener(\"changeSession\", this.$onChangeSession);\n      this.editor.commands.removeListener(\"afterExec\", this.$onAfterExec);\n      this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n      this.editor.tabstopManager = null;\n      this.editor = null;\n    };\n\n    this.onChange = function (delta) {\n      var isRemove = delta.action[0] == \"r\";\n      var selectedTabstop = this.selectedTabstop || {};\n      var parents = selectedTabstop.parents || {};\n      var tabstops = (this.tabstops || []).slice();\n\n      for (var i = 0; i < tabstops.length; i++) {\n        var ts = tabstops[i];\n        var active = ts == selectedTabstop || parents[ts.index];\n        ts.rangeList.$bias = active ? 0 : 1;\n\n        if (delta.action == \"remove\" && ts !== selectedTabstop) {\n          var parentActive = ts.parents && ts.parents[selectedTabstop.index];\n          var startIndex = ts.rangeList.pointIndex(delta.start, parentActive);\n          startIndex = startIndex < 0 ? -startIndex - 1 : startIndex + 1;\n          var endIndex = ts.rangeList.pointIndex(delta.end, parentActive);\n          endIndex = endIndex < 0 ? -endIndex - 1 : endIndex - 1;\n          var toRemove = ts.rangeList.ranges.slice(startIndex, endIndex);\n\n          for (var j = 0; j < toRemove.length; j++) this.removeRange(toRemove[j]);\n        }\n\n        ts.rangeList.$onChange(delta);\n      }\n\n      var session = this.editor.session;\n      if (!this.$inChange && isRemove && session.getLength() == 1 && !session.getValue()) this.detach();\n    };\n\n    this.updateLinkedFields = function () {\n      var ts = this.selectedTabstop;\n      if (!ts || !ts.hasLinkedRanges || !ts.firstNonLinked) return;\n      this.$inChange = true;\n      var session = this.editor.session;\n      var text = session.getTextRange(ts.firstNonLinked);\n\n      for (var i = 0; i < ts.length; i++) {\n        var range = ts[i];\n        if (!range.linked) continue;\n        var original = range.original;\n        var fmt = exports.snippetManager.tmStrFormat(text, original, this.editor);\n        session.replace(range, fmt);\n      }\n\n      this.$inChange = false;\n    };\n\n    this.onAfterExec = function (e) {\n      if (e.command && !e.command.readOnly) this.updateLinkedFields();\n    };\n\n    this.onChangeSelection = function () {\n      if (!this.editor) return;\n      var lead = this.editor.selection.lead;\n      var anchor = this.editor.selection.anchor;\n      var isEmpty = this.editor.selection.isEmpty();\n\n      for (var i = 0; i < this.ranges.length; i++) {\n        if (this.ranges[i].linked) continue;\n        var containsLead = this.ranges[i].contains(lead.row, lead.column);\n        var containsAnchor = isEmpty || this.ranges[i].contains(anchor.row, anchor.column);\n        if (containsLead && containsAnchor) return;\n      }\n\n      this.detach();\n    };\n\n    this.onChangeSession = function () {\n      this.detach();\n    };\n\n    this.tabNext = function (dir) {\n      var max = this.tabstops.length;\n      var index = this.index + (dir || 1);\n      index = Math.min(Math.max(index, 1), max);\n      if (index == max) index = 0;\n      this.selectTabstop(index);\n      if (index === 0) this.detach();\n    };\n\n    this.selectTabstop = function (index) {\n      this.$openTabstops = null;\n      var ts = this.tabstops[this.index];\n      if (ts) this.addTabstopMarkers(ts);\n      this.index = index;\n      ts = this.tabstops[this.index];\n      if (!ts || !ts.length) return;\n      this.selectedTabstop = ts;\n      var range = ts.firstNonLinked || ts;\n      if (ts.choices) range.cursor = range.start;\n\n      if (!this.editor.inVirtualSelectionMode) {\n        var sel = this.editor.multiSelect;\n        sel.toSingleRange(range);\n\n        for (var i = 0; i < ts.length; i++) {\n          if (ts.hasLinkedRanges && ts[i].linked) continue;\n          sel.addRange(ts[i].clone(), true);\n        }\n      } else {\n        this.editor.selection.fromOrientedRange(range);\n      }\n\n      this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n      if (this.selectedTabstop && this.selectedTabstop.choices) this.editor.execCommand(\"startAutocomplete\", {\n        matches: this.selectedTabstop.choices\n      });\n    };\n\n    this.addTabstops = function (tabstops, start, end) {\n      var useLink = this.useLink || !this.editor.getOption(\"enableMultiselect\");\n      if (!this.$openTabstops) this.$openTabstops = [];\n\n      if (!tabstops[0]) {\n        var p = Range.fromPoints(end, end);\n        moveRelative(p.start, start);\n        moveRelative(p.end, start);\n        tabstops[0] = [p];\n        tabstops[0].index = 0;\n      }\n\n      var i = this.index;\n      var arg = [i + 1, 0];\n      var ranges = this.ranges;\n      tabstops.forEach(function (ts, index) {\n        var dest = this.$openTabstops[index] || ts;\n\n        for (var i = 0; i < ts.length; i++) {\n          var p = ts[i];\n          var range = Range.fromPoints(p.start, p.end || p.start);\n          movePoint(range.start, start);\n          movePoint(range.end, start);\n          range.original = p;\n          range.tabstop = dest;\n          ranges.push(range);\n          if (dest != ts) dest.unshift(range);else dest[i] = range;\n\n          if (p.fmtString || dest.firstNonLinked && useLink) {\n            range.linked = true;\n            dest.hasLinkedRanges = true;\n          } else if (!dest.firstNonLinked) dest.firstNonLinked = range;\n        }\n\n        if (!dest.firstNonLinked) dest.hasLinkedRanges = false;\n\n        if (dest === ts) {\n          arg.push(dest);\n          this.$openTabstops[index] = dest;\n        }\n\n        this.addTabstopMarkers(dest);\n        dest.rangeList = dest.rangeList || new RangeList();\n        dest.rangeList.$bias = 0;\n        dest.rangeList.addList(dest);\n      }, this);\n\n      if (arg.length > 2) {\n        if (this.tabstops.length) arg.push(arg.splice(2, 1)[0]);\n        this.tabstops.splice.apply(this.tabstops, arg);\n      }\n    };\n\n    this.addTabstopMarkers = function (ts) {\n      var session = this.editor.session;\n      ts.forEach(function (range) {\n        if (!range.markerId) range.markerId = session.addMarker(range, \"ace_snippet-marker\", \"text\");\n      });\n    };\n\n    this.removeTabstopMarkers = function (ts) {\n      var session = this.editor.session;\n      ts.forEach(function (range) {\n        session.removeMarker(range.markerId);\n        range.markerId = null;\n      });\n    };\n\n    this.removeRange = function (range) {\n      var i = range.tabstop.indexOf(range);\n      if (i != -1) range.tabstop.splice(i, 1);\n      i = this.ranges.indexOf(range);\n      if (i != -1) this.ranges.splice(i, 1);\n      i = range.tabstop.rangeList.ranges.indexOf(range);\n      if (i != -1) range.tabstop.splice(i, 1);\n      this.editor.session.removeMarker(range.markerId);\n\n      if (!range.tabstop.length) {\n        i = this.tabstops.indexOf(range.tabstop);\n        if (i != -1) this.tabstops.splice(i, 1);\n        if (!this.tabstops.length) this.detach();\n      }\n    };\n\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys({\n      \"Tab\": function (editor) {\n        if (exports.snippetManager && exports.snippetManager.expandWithTab(editor)) return;\n        editor.tabstopManager.tabNext(1);\n        editor.renderer.scrollCursorIntoView();\n      },\n      \"Shift-Tab\": function (editor) {\n        editor.tabstopManager.tabNext(-1);\n        editor.renderer.scrollCursorIntoView();\n      },\n      \"Esc\": function (editor) {\n        editor.tabstopManager.detach();\n      }\n    });\n  }).call(TabstopManager.prototype);\n\n  var movePoint = function (point, diff) {\n    if (point.row == 0) point.column += diff.column;\n    point.row += diff.row;\n  };\n\n  var moveRelative = function (point, start) {\n    if (point.row == start.row) point.column -= start.column;\n    point.row -= start.row;\n  };\n\n  dom.importCssString(\"\\\n.ace_snippet-marker {\\\n    -moz-box-sizing: border-box;\\\n    box-sizing: border-box;\\\n    background: rgba(194, 193, 208, 0.09);\\\n    border: 1px dotted rgba(211, 208, 235, 0.62);\\\n    position: absolute;\\\n}\", \"snippets.css\", false);\n  exports.snippetManager = new SnippetManager();\n\n  var Editor = require(\"./editor\").Editor;\n\n  (function () {\n    this.insertSnippet = function (content, options) {\n      return exports.snippetManager.insertSnippet(this, content, options);\n    };\n\n    this.expandSnippet = function (options) {\n      return exports.snippetManager.expandWithTab(this, options);\n    };\n  }).call(Editor.prototype);\n});\nace.define(\"ace/autocomplete/popup\", [\"require\", \"exports\", \"module\", \"ace/virtual_renderer\", \"ace/editor\", \"ace/range\", \"ace/lib/event\", \"ace/lib/lang\", \"ace/lib/dom\"], function (require, exports, module) {\n  \"use strict\";\n\n  var Renderer = require(\"../virtual_renderer\").VirtualRenderer;\n\n  var Editor = require(\"../editor\").Editor;\n\n  var Range = require(\"../range\").Range;\n\n  var event = require(\"../lib/event\");\n\n  var lang = require(\"../lib/lang\");\n\n  var dom = require(\"../lib/dom\");\n\n  var $singleLineEditor = function (el) {\n    var renderer = new Renderer(el);\n    renderer.$maxLines = 4;\n    var editor = new Editor(renderer);\n    editor.setHighlightActiveLine(false);\n    editor.setShowPrintMargin(false);\n    editor.renderer.setShowGutter(false);\n    editor.renderer.setHighlightGutterLine(false);\n    editor.$mouseHandler.$focusTimeout = 0;\n    editor.$highlightTagPending = true;\n    return editor;\n  };\n\n  var AcePopup = function (parentNode) {\n    var el = dom.createElement(\"div\");\n    var popup = new $singleLineEditor(el);\n    if (parentNode) parentNode.appendChild(el);\n    el.style.display = \"none\";\n    popup.renderer.content.style.cursor = \"default\";\n    popup.renderer.setStyle(\"ace_autocomplete\");\n    popup.setOption(\"displayIndentGuides\", false);\n    popup.setOption(\"dragDelay\", 150);\n\n    var noop = function () {};\n\n    popup.focus = noop;\n    popup.$isFocused = true;\n    popup.renderer.$cursorLayer.restartTimer = noop;\n    popup.renderer.$cursorLayer.element.style.opacity = 0;\n    popup.renderer.$maxLines = 8;\n    popup.renderer.$keepTextAreaAtCursor = false;\n    popup.setHighlightActiveLine(false);\n    popup.session.highlight(\"\");\n    popup.session.$searchHighlight.clazz = \"ace_highlight-marker\";\n    popup.on(\"mousedown\", function (e) {\n      var pos = e.getDocumentPosition();\n      popup.selection.moveToPosition(pos);\n      selectionMarker.start.row = selectionMarker.end.row = pos.row;\n      e.stop();\n    });\n    var lastMouseEvent;\n    var hoverMarker = new Range(-1, 0, -1, Infinity);\n    var selectionMarker = new Range(-1, 0, -1, Infinity);\n    selectionMarker.id = popup.session.addMarker(selectionMarker, \"ace_active-line\", \"fullLine\");\n\n    popup.setSelectOnHover = function (val) {\n      if (!val) {\n        hoverMarker.id = popup.session.addMarker(hoverMarker, \"ace_line-hover\", \"fullLine\");\n      } else if (hoverMarker.id) {\n        popup.session.removeMarker(hoverMarker.id);\n        hoverMarker.id = null;\n      }\n    };\n\n    popup.setSelectOnHover(false);\n    popup.on(\"mousemove\", function (e) {\n      if (!lastMouseEvent) {\n        lastMouseEvent = e;\n        return;\n      }\n\n      if (lastMouseEvent.x == e.x && lastMouseEvent.y == e.y) {\n        return;\n      }\n\n      lastMouseEvent = e;\n      lastMouseEvent.scrollTop = popup.renderer.scrollTop;\n      var row = lastMouseEvent.getDocumentPosition().row;\n\n      if (hoverMarker.start.row != row) {\n        if (!hoverMarker.id) popup.setRow(row);\n        setHoverMarker(row);\n      }\n    });\n    popup.renderer.on(\"beforeRender\", function () {\n      if (lastMouseEvent && hoverMarker.start.row != -1) {\n        lastMouseEvent.$pos = null;\n        var row = lastMouseEvent.getDocumentPosition().row;\n        if (!hoverMarker.id) popup.setRow(row);\n        setHoverMarker(row, true);\n      }\n    });\n    popup.renderer.on(\"afterRender\", function () {\n      var row = popup.getRow();\n      var t = popup.renderer.$textLayer;\n      var selected = t.element.childNodes[row - t.config.firstRow];\n      if (selected !== t.selectedNode && t.selectedNode) dom.removeCssClass(t.selectedNode, \"ace_selected\");\n      t.selectedNode = selected;\n      if (selected) dom.addCssClass(selected, \"ace_selected\");\n    });\n\n    var hideHoverMarker = function () {\n      setHoverMarker(-1);\n    };\n\n    var setHoverMarker = function (row, suppressRedraw) {\n      if (row !== hoverMarker.start.row) {\n        hoverMarker.start.row = hoverMarker.end.row = row;\n        if (!suppressRedraw) popup.session._emit(\"changeBackMarker\");\n\n        popup._emit(\"changeHoverMarker\");\n      }\n    };\n\n    popup.getHoveredRow = function () {\n      return hoverMarker.start.row;\n    };\n\n    event.addListener(popup.container, \"mouseout\", hideHoverMarker);\n    popup.on(\"hide\", hideHoverMarker);\n    popup.on(\"changeSelection\", hideHoverMarker);\n\n    popup.session.doc.getLength = function () {\n      return popup.data.length;\n    };\n\n    popup.session.doc.getLine = function (i) {\n      var data = popup.data[i];\n      if (typeof data == \"string\") return data;\n      return data && data.value || \"\";\n    };\n\n    var bgTokenizer = popup.session.bgTokenizer;\n\n    bgTokenizer.$tokenizeRow = function (row) {\n      var data = popup.data[row];\n      var tokens = [];\n      if (!data) return tokens;\n      if (typeof data == \"string\") data = {\n        value: data\n      };\n      var caption = data.caption || data.value || data.name;\n\n      function addToken(value, className) {\n        value && tokens.push({\n          type: (data.className || \"\") + (className || \"\"),\n          value: value\n        });\n      }\n\n      var lower = caption.toLowerCase();\n      var filterText = (popup.filterText || \"\").toLowerCase();\n      var lastIndex = 0;\n      var lastI = 0;\n\n      for (var i = 0; i <= filterText.length; i++) {\n        if (i != lastI && (data.matchMask & 1 << i || i == filterText.length)) {\n          var sub = filterText.slice(lastI, i);\n          lastI = i;\n          var index = lower.indexOf(sub, lastIndex);\n          if (index == -1) continue;\n          addToken(caption.slice(lastIndex, index), \"\");\n          lastIndex = index + sub.length;\n          addToken(caption.slice(index, lastIndex), \"completion-highlight\");\n        }\n      }\n\n      addToken(caption.slice(lastIndex, caption.length), \"\");\n      if (data.meta) tokens.push({\n        type: \"completion-meta\",\n        value: data.meta\n      });\n      if (data.message) tokens.push({\n        type: \"completion-message\",\n        value: data.message\n      });\n      return tokens;\n    };\n\n    bgTokenizer.$updateOnChange = noop;\n    bgTokenizer.start = noop;\n\n    popup.session.$computeWidth = function () {\n      return this.screenWidth = 0;\n    };\n\n    popup.isOpen = false;\n    popup.isTopdown = false;\n    popup.autoSelect = true;\n    popup.filterText = \"\";\n    popup.data = [];\n\n    popup.setData = function (list, filterText) {\n      popup.filterText = filterText || \"\";\n      popup.setValue(lang.stringRepeat(\"\\n\", list.length), -1);\n      popup.data = list || [];\n      popup.setRow(0);\n    };\n\n    popup.getData = function (row) {\n      return popup.data[row];\n    };\n\n    popup.getRow = function () {\n      return selectionMarker.start.row;\n    };\n\n    popup.setRow = function (line) {\n      line = Math.max(this.autoSelect ? 0 : -1, Math.min(this.data.length, line));\n\n      if (selectionMarker.start.row != line) {\n        popup.selection.clearSelection();\n        selectionMarker.start.row = selectionMarker.end.row = line || 0;\n\n        popup.session._emit(\"changeBackMarker\");\n\n        popup.moveCursorTo(line || 0, 0);\n        if (popup.isOpen) popup._signal(\"select\");\n      }\n    };\n\n    popup.on(\"changeSelection\", function () {\n      if (popup.isOpen) popup.setRow(popup.selection.lead.row);\n      popup.renderer.scrollCursorIntoView();\n    });\n\n    popup.hide = function () {\n      this.container.style.display = \"none\";\n\n      this._signal(\"hide\");\n\n      popup.isOpen = false;\n    };\n\n    popup.show = function (pos, lineHeight, topdownOnly) {\n      var el = this.container;\n      var screenHeight = window.innerHeight;\n      var screenWidth = window.innerWidth;\n      var renderer = this.renderer;\n      var maxH = renderer.$maxLines * lineHeight * 1.4;\n      var top = pos.top + this.$borderSize;\n      var allowTopdown = top > screenHeight / 2 && !topdownOnly;\n\n      if (allowTopdown && top + lineHeight + maxH > screenHeight) {\n        renderer.$maxPixelHeight = top - 2 * this.$borderSize;\n        el.style.top = \"\";\n        el.style.bottom = screenHeight - top + \"px\";\n        popup.isTopdown = false;\n      } else {\n        top += lineHeight;\n        renderer.$maxPixelHeight = screenHeight - top - 0.2 * lineHeight;\n        el.style.top = top + \"px\";\n        el.style.bottom = \"\";\n        popup.isTopdown = true;\n      }\n\n      el.style.display = \"\";\n      var left = pos.left;\n      if (left + el.offsetWidth > screenWidth) left = screenWidth - el.offsetWidth;\n      el.style.left = left + \"px\";\n\n      this._signal(\"show\");\n\n      lastMouseEvent = null;\n      popup.isOpen = true;\n    };\n\n    popup.goTo = function (where) {\n      var row = this.getRow();\n      var max = this.session.getLength() - 1;\n\n      switch (where) {\n        case \"up\":\n          row = row <= 0 ? max : row - 1;\n          break;\n\n        case \"down\":\n          row = row >= max ? -1 : row + 1;\n          break;\n\n        case \"start\":\n          row = 0;\n          break;\n\n        case \"end\":\n          row = max;\n          break;\n      }\n\n      this.setRow(row);\n    };\n\n    popup.getTextLeftOffset = function () {\n      return this.$borderSize + this.renderer.$padding + this.$imageSize;\n    };\n\n    popup.$imageSize = 0;\n    popup.$borderSize = 1;\n    return popup;\n  };\n\n  dom.importCssString(\"\\\n.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #CAD6FA;\\\n    z-index: 1;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #3a674e;\\\n}\\\n.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid #abbffe;\\\n    margin-top: -1px;\\\n    background: rgba(233,233,253,0.4);\\\n    position: absolute;\\\n    z-index: 2;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid rgba(109, 150, 13, 0.8);\\\n    background: rgba(58, 103, 78, 0.62);\\\n}\\\n.ace_completion-meta {\\\n    opacity: 0.5;\\\n    margin: 0.9em;\\\n}\\\n.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #2d69c7;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #93ca12;\\\n}\\\n.ace_autocomplete.ace-tm .ace_marker-layer .ace_active-line {\\\n    background-color: #CAD6FA;\\\n    z-index: 1;\\\n}\\\n.ace_autocomplete.ace-tm .ace_line-hover {\\\n    border: 1px solid #abbffe;\\\n    margin-top: -1px;\\\n    background: rgba(233,233,253,0.4);\\\n}\\\n.ace_autocomplete .ace_line-hover {\\\n    position: absolute;\\\n    z-index: 2;\\\n}\\\n.ace_autocomplete .ace_scroller {\\\n    background: none;\\\n    border: none;\\\n    box-shadow: none;\\\n}\\\n.ace_rightAlignedText {\\\n    color: gray;\\\n    display: inline-block;\\\n    position: absolute;\\\n    right: 4px;\\\n    text-align: right;\\\n    z-index: -1;\\\n}\\\n.ace_completion-message {\\\n    color: blue;\\\n}\\\n.ace_autocomplete .ace_completion-highlight{\\\n    text-shadow: 0 0 0.01em;\\\n}\\\n.ace_autocomplete {\\\n    width: 280px;\\\n    z-index: 200000;\\\n    background: #fbfbfb;\\\n    color: #444;\\\n    border: 1px lightgray solid;\\\n    position: fixed;\\\n    box-shadow: 2px 3px 5px rgba(0,0,0,.2);\\\n    line-height: 1.4;\\\n    background: #fefefe;\\\n    color: #111;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete {\\\n    border: 1px #484747 solid;\\\n    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);\\\n    line-height: 1.4;\\\n    background: #25282c;\\\n    color: #c1c1c1;\\\n}\", \"autocompletion.css\", false);\n  exports.AcePopup = AcePopup;\n  exports.$singleLineEditor = $singleLineEditor;\n});\nace.define(\"ace/autocomplete/util\", [\"require\", \"exports\", \"module\"], function (require, exports, module) {\n  \"use strict\";\n\n  exports.parForEach = function (array, fn, callback) {\n    var completed = 0;\n    var arLength = array.length;\n    if (arLength === 0) callback();\n\n    for (var i = 0; i < arLength; i++) {\n      fn(array[i], function (result, err) {\n        completed++;\n        if (completed === arLength) callback(result, err);\n      });\n    }\n  };\n\n  var ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\u2000\\u2070-\\uFFFF]/;\n\n  exports.retrievePrecedingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n\n    for (var i = pos - 1; i >= 0; i--) {\n      if (regex.test(text[i])) buf.push(text[i]);else break;\n    }\n\n    return buf.reverse().join(\"\");\n  };\n\n  exports.retrieveFollowingIdentifier = function (text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n\n    for (var i = pos; i < text.length; i++) {\n      if (regex.test(text[i])) buf.push(text[i]);else break;\n    }\n\n    return buf;\n  };\n\n  exports.getCompletionPrefix = function (editor) {\n    var pos = editor.getCursorPosition();\n    var line = editor.session.getLine(pos.row);\n    var prefix;\n    editor.completers.forEach(function (completer) {\n      if (completer.identifierRegexps) {\n        completer.identifierRegexps.forEach(function (identifierRegex) {\n          if (!prefix && identifierRegex) prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\n        }.bind(this));\n      }\n    }.bind(this));\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\n  };\n});\nace.define(\"ace/autocomplete\", [\"require\", \"exports\", \"module\", \"ace/keyboard/hash_handler\", \"ace/autocomplete/popup\", \"ace/autocomplete/util\", \"ace/lib/lang\", \"ace/lib/dom\", \"ace/snippets\", \"ace/config\"], function (require, exports, module) {\n  \"use strict\";\n\n  var HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\n\n  var AcePopup = require(\"./autocomplete/popup\").AcePopup;\n\n  var util = require(\"./autocomplete/util\");\n\n  var lang = require(\"./lib/lang\");\n\n  var dom = require(\"./lib/dom\");\n\n  var snippetManager = require(\"./snippets\").snippetManager;\n\n  var config = require(\"./config\");\n\n  var Autocomplete = function () {\n    this.autoInsert = false;\n    this.autoSelect = true;\n    this.exactMatch = false;\n    this.gatherCompletionsId = 0;\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys(this.commands);\n    this.blurListener = this.blurListener.bind(this);\n    this.changeListener = this.changeListener.bind(this);\n    this.mousedownListener = this.mousedownListener.bind(this);\n    this.mousewheelListener = this.mousewheelListener.bind(this);\n    this.changeTimer = lang.delayedCall(function () {\n      this.updateCompletions(true);\n    }.bind(this));\n    this.tooltipTimer = lang.delayedCall(this.updateDocTooltip.bind(this), 50);\n  };\n\n  (function () {\n    this.$init = function () {\n      this.popup = new AcePopup(document.body || document.documentElement);\n      this.popup.on(\"click\", function (e) {\n        this.insertMatch();\n        e.stop();\n      }.bind(this));\n      this.popup.focus = this.editor.focus.bind(this.editor);\n      this.popup.on(\"show\", this.tooltipTimer.bind(null, null));\n      this.popup.on(\"select\", this.tooltipTimer.bind(null, null));\n      this.popup.on(\"changeHoverMarker\", this.tooltipTimer.bind(null, null));\n      return this.popup;\n    };\n\n    this.getPopup = function () {\n      return this.popup || this.$init();\n    };\n\n    this.openPopup = function (editor, prefix, keepPopupPosition) {\n      if (!this.popup) this.$init();\n      this.popup.autoSelect = this.autoSelect;\n      this.popup.setData(this.completions.filtered, this.completions.filterText);\n      editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n      var renderer = editor.renderer;\n      this.popup.setRow(this.autoSelect ? 0 : -1);\n\n      if (!keepPopupPosition) {\n        this.popup.setTheme(editor.getTheme());\n        this.popup.setFontSize(editor.getFontSize());\n        var lineHeight = renderer.layerConfig.lineHeight;\n        var pos = renderer.$cursorLayer.getPixelPosition(this.base, true);\n        pos.left -= this.popup.getTextLeftOffset();\n        var rect = editor.container.getBoundingClientRect();\n        pos.top += rect.top - renderer.layerConfig.offset;\n        pos.left += rect.left - editor.renderer.scrollLeft;\n        pos.left += renderer.gutterWidth;\n        this.popup.show(pos, lineHeight);\n      } else if (keepPopupPosition && !prefix) {\n        this.detach();\n      }\n\n      this.changeTimer.cancel();\n    };\n\n    this.detach = function () {\n      this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n      this.editor.off(\"changeSelection\", this.changeListener);\n      this.editor.off(\"blur\", this.blurListener);\n      this.editor.off(\"mousedown\", this.mousedownListener);\n      this.editor.off(\"mousewheel\", this.mousewheelListener);\n      this.changeTimer.cancel();\n      this.hideDocTooltip();\n      this.gatherCompletionsId += 1;\n      if (this.popup && this.popup.isOpen) this.popup.hide();\n      if (this.base) this.base.detach();\n      this.activated = false;\n      this.completions = this.base = null;\n    };\n\n    this.changeListener = function (e) {\n      var cursor = this.editor.selection.lead;\n\n      if (cursor.row != this.base.row || cursor.column < this.base.column) {\n        this.detach();\n      }\n\n      if (this.activated) this.changeTimer.schedule();else this.detach();\n    };\n\n    this.blurListener = function (e) {\n      var el = document.activeElement;\n      var text = this.editor.textInput.getElement();\n      var fromTooltip = e.relatedTarget && this.tooltipNode && this.tooltipNode.contains(e.relatedTarget);\n      var container = this.popup && this.popup.container;\n\n      if (el != text && el.parentNode != container && !fromTooltip && el != this.tooltipNode && e.relatedTarget != text) {\n        this.detach();\n      }\n    };\n\n    this.mousedownListener = function (e) {\n      this.detach();\n    };\n\n    this.mousewheelListener = function (e) {\n      this.detach();\n    };\n\n    this.goTo = function (where) {\n      this.popup.goTo(where);\n    };\n\n    this.insertMatch = function (data, options) {\n      if (!data) data = this.popup.getData(this.popup.getRow());\n      if (!data) return false;\n      var completions = this.completions;\n      this.editor.startOperation({\n        command: {\n          name: \"insertMatch\"\n        }\n      });\n\n      if (data.completer && data.completer.insertMatch) {\n        data.completer.insertMatch(this.editor, data);\n      } else {\n        if (completions.filterText) {\n          var ranges = this.editor.selection.getAllRanges();\n\n          for (var i = 0, range; range = ranges[i]; i++) {\n            range.start.column -= completions.filterText.length;\n            this.editor.session.remove(range);\n          }\n        }\n\n        if (data.snippet) snippetManager.insertSnippet(this.editor, data.snippet);else this.editor.execCommand(\"insertstring\", data.value || data);\n      }\n\n      if (this.completions == completions) this.detach();\n      this.editor.endOperation();\n    };\n\n    this.commands = {\n      \"Up\": function (editor) {\n        editor.completer.goTo(\"up\");\n      },\n      \"Down\": function (editor) {\n        editor.completer.goTo(\"down\");\n      },\n      \"Ctrl-Up|Ctrl-Home\": function (editor) {\n        editor.completer.goTo(\"start\");\n      },\n      \"Ctrl-Down|Ctrl-End\": function (editor) {\n        editor.completer.goTo(\"end\");\n      },\n      \"Esc\": function (editor) {\n        editor.completer.detach();\n      },\n      \"Return\": function (editor) {\n        return editor.completer.insertMatch();\n      },\n      \"Shift-Return\": function (editor) {\n        editor.completer.insertMatch(null, {\n          deleteSuffix: true\n        });\n      },\n      \"Tab\": function (editor) {\n        var result = editor.completer.insertMatch();\n        if (!result && !editor.tabstopManager) editor.completer.goTo(\"down\");else return result;\n      },\n      \"PageUp\": function (editor) {\n        editor.completer.popup.gotoPageUp();\n      },\n      \"PageDown\": function (editor) {\n        editor.completer.popup.gotoPageDown();\n      }\n    };\n\n    this.gatherCompletions = function (editor, callback) {\n      var session = editor.getSession();\n      var pos = editor.getCursorPosition();\n      var prefix = util.getCompletionPrefix(editor);\n      this.base = session.doc.createAnchor(pos.row, pos.column - prefix.length);\n      this.base.$insertRight = true;\n      var matches = [];\n      var total = editor.completers.length;\n      editor.completers.forEach(function (completer, i) {\n        completer.getCompletions(editor, session, pos, prefix, function (err, results) {\n          if (!err && results) matches = matches.concat(results);\n          callback(null, {\n            prefix: util.getCompletionPrefix(editor),\n            matches: matches,\n            finished: --total === 0\n          });\n        });\n      });\n      return true;\n    };\n\n    this.showPopup = function (editor, options) {\n      if (this.editor) this.detach();\n      this.activated = true;\n      this.editor = editor;\n\n      if (editor.completer != this) {\n        if (editor.completer) editor.completer.detach();\n        editor.completer = this;\n      }\n\n      editor.on(\"changeSelection\", this.changeListener);\n      editor.on(\"blur\", this.blurListener);\n      editor.on(\"mousedown\", this.mousedownListener);\n      editor.on(\"mousewheel\", this.mousewheelListener);\n      this.updateCompletions(false, options);\n    };\n\n    this.updateCompletions = function (keepPopupPosition, options) {\n      if (keepPopupPosition && this.base && this.completions) {\n        var pos = this.editor.getCursorPosition();\n        var prefix = this.editor.session.getTextRange({\n          start: this.base,\n          end: pos\n        });\n        if (prefix == this.completions.filterText) return;\n        this.completions.setFilter(prefix);\n        if (!this.completions.filtered.length) return this.detach();\n        if (this.completions.filtered.length == 1 && this.completions.filtered[0].value == prefix && !this.completions.filtered[0].snippet) return this.detach();\n        this.openPopup(this.editor, prefix, keepPopupPosition);\n        return;\n      }\n\n      if (options && options.matches) {\n        var pos = this.editor.getSelectionRange().start;\n        this.base = this.editor.session.doc.createAnchor(pos.row, pos.column);\n        this.base.$insertRight = true;\n        this.completions = new FilteredList(options.matches);\n        return this.openPopup(this.editor, \"\", keepPopupPosition);\n      }\n\n      var _id = this.gatherCompletionsId;\n\n      var detachIfFinished = function (results) {\n        if (!results.finished) return;\n        return this.detach();\n      }.bind(this);\n\n      var processResults = function (results) {\n        var prefix = results.prefix;\n        var matches = results.matches;\n        this.completions = new FilteredList(matches);\n        if (this.exactMatch) this.completions.exactMatch = true;\n        this.completions.setFilter(prefix);\n        var filtered = this.completions.filtered;\n        if (!filtered.length) return detachIfFinished(results);\n        if (filtered.length == 1 && filtered[0].value == prefix && !filtered[0].snippet) return detachIfFinished(results);\n        if (this.autoInsert && filtered.length == 1 && results.finished) return this.insertMatch(filtered[0]);\n        this.openPopup(this.editor, prefix, keepPopupPosition);\n      }.bind(this);\n\n      var isImmediate = true;\n      var immediateResults = null;\n      this.gatherCompletions(this.editor, function (err, results) {\n        var prefix = results.prefix;\n        var matches = results && results.matches;\n        if (!matches || !matches.length) return detachIfFinished(results);\n        if (prefix.indexOf(results.prefix) !== 0 || _id != this.gatherCompletionsId) return;\n\n        if (isImmediate) {\n          immediateResults = results;\n          return;\n        }\n\n        processResults(results);\n      }.bind(this));\n      isImmediate = false;\n\n      if (immediateResults) {\n        var results = immediateResults;\n        immediateResults = null;\n        processResults(results);\n      }\n    };\n\n    this.cancelContextMenu = function () {\n      this.editor.$mouseHandler.cancelContextMenu();\n    };\n\n    this.updateDocTooltip = function () {\n      var popup = this.popup;\n      var all = popup.data;\n      var selected = all && (all[popup.getHoveredRow()] || all[popup.getRow()]);\n      var doc = null;\n      if (!selected || !this.editor || !this.popup.isOpen) return this.hideDocTooltip();\n      this.editor.completers.some(function (completer) {\n        if (completer.getDocTooltip) doc = completer.getDocTooltip(selected);\n        return doc;\n      });\n      if (!doc && typeof selected != \"string\") doc = selected;\n      if (typeof doc == \"string\") doc = {\n        docText: doc\n      };\n      if (!doc || !(doc.docHTML || doc.docText)) return this.hideDocTooltip();\n      this.showDocTooltip(doc);\n    };\n\n    this.showDocTooltip = function (item) {\n      if (!this.tooltipNode) {\n        this.tooltipNode = dom.createElement(\"div\");\n        this.tooltipNode.className = \"ace_tooltip ace_doc-tooltip\";\n        this.tooltipNode.style.margin = 0;\n        this.tooltipNode.style.pointerEvents = \"auto\";\n        this.tooltipNode.tabIndex = -1;\n        this.tooltipNode.onblur = this.blurListener.bind(this);\n        this.tooltipNode.onclick = this.onTooltipClick.bind(this);\n      }\n\n      var tooltipNode = this.tooltipNode;\n\n      if (item.docHTML) {\n        tooltipNode.innerHTML = item.docHTML;\n      } else if (item.docText) {\n        tooltipNode.textContent = item.docText;\n      }\n\n      if (!tooltipNode.parentNode) document.body.appendChild(tooltipNode);\n      var popup = this.popup;\n      var rect = popup.container.getBoundingClientRect();\n      tooltipNode.style.top = popup.container.style.top;\n      tooltipNode.style.bottom = popup.container.style.bottom;\n      tooltipNode.style.display = \"block\";\n\n      if (window.innerWidth - rect.right < 320) {\n        if (rect.left < 320) {\n          if (popup.isTopdown) {\n            tooltipNode.style.top = rect.bottom + \"px\";\n            tooltipNode.style.left = rect.left + \"px\";\n            tooltipNode.style.right = \"\";\n            tooltipNode.style.bottom = \"\";\n          } else {\n            tooltipNode.style.top = popup.container.offsetTop - tooltipNode.offsetHeight + \"px\";\n            tooltipNode.style.left = rect.left + \"px\";\n            tooltipNode.style.right = \"\";\n            tooltipNode.style.bottom = \"\";\n          }\n        } else {\n          tooltipNode.style.right = window.innerWidth - rect.left + \"px\";\n          tooltipNode.style.left = \"\";\n        }\n      } else {\n        tooltipNode.style.left = rect.right + 1 + \"px\";\n        tooltipNode.style.right = \"\";\n      }\n    };\n\n    this.hideDocTooltip = function () {\n      this.tooltipTimer.cancel();\n      if (!this.tooltipNode) return;\n      var el = this.tooltipNode;\n      if (!this.editor.isFocused() && document.activeElement == el) this.editor.focus();\n      this.tooltipNode = null;\n      if (el.parentNode) el.parentNode.removeChild(el);\n    };\n\n    this.onTooltipClick = function (e) {\n      var a = e.target;\n\n      while (a && a != this.tooltipNode) {\n        if (a.nodeName == \"A\" && a.href) {\n          a.rel = \"noreferrer\";\n          a.target = \"_blank\";\n          break;\n        }\n\n        a = a.parentNode;\n      }\n    };\n\n    this.destroy = function () {\n      this.detach();\n\n      if (this.popup) {\n        this.popup.destroy();\n        var el = this.popup.container;\n        if (el && el.parentNode) el.parentNode.removeChild(el);\n      }\n\n      if (this.editor && this.editor.completer == this) this.editor.completer == null;\n      this.popup = null;\n    };\n  }).call(Autocomplete.prototype);\n\n  Autocomplete.for = function (editor) {\n    if (editor.completer) {\n      return editor.completer;\n    }\n\n    if (config.get(\"sharedPopups\")) {\n      if (!Autocomplete.$shared) Autocomplete.$sharedInstance = new Autocomplete();\n      editor.completer = Autocomplete.$sharedInstance;\n    } else {\n      editor.completer = new Autocomplete();\n      editor.once(\"destroy\", function (e, editor) {\n        editor.completer.destroy();\n      });\n    }\n\n    return editor.completer;\n  };\n\n  Autocomplete.startCommand = {\n    name: \"startAutocomplete\",\n    exec: function (editor, options) {\n      var completer = Autocomplete.for(editor);\n      completer.autoInsert = false;\n      completer.autoSelect = true;\n      completer.showPopup(editor, options);\n      completer.cancelContextMenu();\n    },\n    bindKey: \"Ctrl-Space|Ctrl-Shift-Space|Alt-Space\"\n  };\n\n  var FilteredList = function (array, filterText) {\n    this.all = array;\n    this.filtered = array;\n    this.filterText = filterText || \"\";\n    this.exactMatch = false;\n  };\n\n  (function () {\n    this.setFilter = function (str) {\n      if (str.length > this.filterText && str.lastIndexOf(this.filterText, 0) === 0) var matches = this.filtered;else var matches = this.all;\n      this.filterText = str;\n      matches = this.filterCompletions(matches, this.filterText);\n      matches = matches.sort(function (a, b) {\n        return b.exactMatch - a.exactMatch || b.$score - a.$score || (a.caption || a.value).localeCompare(b.caption || b.value);\n      });\n      var prev = null;\n      matches = matches.filter(function (item) {\n        var caption = item.snippet || item.caption || item.value;\n        if (caption === prev) return false;\n        prev = caption;\n        return true;\n      });\n      this.filtered = matches;\n    };\n\n    this.filterCompletions = function (items, needle) {\n      var results = [];\n      var upper = needle.toUpperCase();\n      var lower = needle.toLowerCase();\n\n      loop: for (var i = 0, item; item = items[i]; i++) {\n        var caption = item.caption || item.value || item.snippet;\n        if (!caption) continue;\n        var lastIndex = -1;\n        var matchMask = 0;\n        var penalty = 0;\n        var index, distance;\n\n        if (this.exactMatch) {\n          if (needle !== caption.substr(0, needle.length)) continue loop;\n        } else {\n          var fullMatchIndex = caption.toLowerCase().indexOf(lower);\n\n          if (fullMatchIndex > -1) {\n            penalty = fullMatchIndex;\n          } else {\n            for (var j = 0; j < needle.length; j++) {\n              var i1 = caption.indexOf(lower[j], lastIndex + 1);\n              var i2 = caption.indexOf(upper[j], lastIndex + 1);\n              index = i1 >= 0 ? i2 < 0 || i1 < i2 ? i1 : i2 : i2;\n              if (index < 0) continue loop;\n              distance = index - lastIndex - 1;\n\n              if (distance > 0) {\n                if (lastIndex === -1) penalty += 10;\n                penalty += distance;\n                matchMask = matchMask | 1 << j;\n              }\n\n              lastIndex = index;\n            }\n          }\n        }\n\n        item.matchMask = matchMask;\n        item.exactMatch = penalty ? 0 : 1;\n        item.$score = (item.score || 0) - penalty;\n        results.push(item);\n      }\n\n      return results;\n    };\n  }).call(FilteredList.prototype);\n  exports.Autocomplete = Autocomplete;\n  exports.FilteredList = FilteredList;\n});\nace.define(\"ace/autocomplete/text_completer\", [\"require\", \"exports\", \"module\", \"ace/range\"], function (require, exports, module) {\n  var Range = require(\"../range\").Range;\n\n  var splitRegex = /[^a-zA-Z_0-9\\$\\-\\u00C0-\\u1FFF\\u2C00-\\uD7FF\\w]+/;\n\n  function getWordIndex(doc, pos) {\n    var textBefore = doc.getTextRange(Range.fromPoints({\n      row: 0,\n      column: 0\n    }, pos));\n    return textBefore.split(splitRegex).length - 1;\n  }\n\n  function wordDistance(doc, pos) {\n    var prefixPos = getWordIndex(doc, pos);\n    var words = doc.getValue().split(splitRegex);\n    var wordScores = Object.create(null);\n    var currentWord = words[prefixPos];\n    words.forEach(function (word, idx) {\n      if (!word || word === currentWord) return;\n      var distance = Math.abs(prefixPos - idx);\n      var score = words.length - distance;\n\n      if (wordScores[word]) {\n        wordScores[word] = Math.max(score, wordScores[word]);\n      } else {\n        wordScores[word] = score;\n      }\n    });\n    return wordScores;\n  }\n\n  exports.getCompletions = function (editor, session, pos, prefix, callback) {\n    var wordScore = wordDistance(session, pos);\n    var wordList = Object.keys(wordScore);\n    callback(null, wordList.map(function (word) {\n      return {\n        caption: word,\n        value: word,\n        score: wordScore[word],\n        meta: \"local\"\n      };\n    }));\n  };\n});\nace.define(\"ace/ext/language_tools\", [\"require\", \"exports\", \"module\", \"ace/snippets\", \"ace/autocomplete\", \"ace/config\", \"ace/lib/lang\", \"ace/autocomplete/util\", \"ace/autocomplete/text_completer\", \"ace/editor\", \"ace/config\"], function (require, exports, module) {\n  \"use strict\";\n\n  var snippetManager = require(\"../snippets\").snippetManager;\n\n  var Autocomplete = require(\"../autocomplete\").Autocomplete;\n\n  var config = require(\"../config\");\n\n  var lang = require(\"../lib/lang\");\n\n  var util = require(\"../autocomplete/util\");\n\n  var textCompleter = require(\"../autocomplete/text_completer\");\n\n  var keyWordCompleter = {\n    getCompletions: function (editor, session, pos, prefix, callback) {\n      if (session.$mode.completer) {\n        return session.$mode.completer.getCompletions(editor, session, pos, prefix, callback);\n      }\n\n      var state = editor.session.getState(pos.row);\n      var completions = session.$mode.getCompletions(state, session, pos, prefix);\n      callback(null, completions);\n    }\n  };\n\n  var transformSnippetTooltip = function (str) {\n    var record = {};\n    return str.replace(/\\${(\\d+)(:(.*?))?}/g, function (_, p1, p2, p3) {\n      return record[p1] = p3 || '';\n    }).replace(/\\$(\\d+?)/g, function (_, p1) {\n      return record[p1];\n    });\n  };\n\n  var snippetCompleter = {\n    getCompletions: function (editor, session, pos, prefix, callback) {\n      var scopes = [];\n      var token = session.getTokenAt(pos.row, pos.column);\n      if (token && token.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\\.xml$/)) scopes.push('html-tag');else scopes = snippetManager.getActiveScopes(editor);\n      var snippetMap = snippetManager.snippetMap;\n      var completions = [];\n      scopes.forEach(function (scope) {\n        var snippets = snippetMap[scope] || [];\n\n        for (var i = snippets.length; i--;) {\n          var s = snippets[i];\n          var caption = s.name || s.tabTrigger;\n          if (!caption) continue;\n          completions.push({\n            caption: caption,\n            snippet: s.content,\n            meta: s.tabTrigger && !s.name ? s.tabTrigger + \"\\u21E5 \" : \"snippet\",\n            type: \"snippet\"\n          });\n        }\n      }, this);\n      callback(null, completions);\n    },\n    getDocTooltip: function (item) {\n      if (item.type == \"snippet\" && !item.docHTML) {\n        item.docHTML = [\"<b>\", lang.escapeHTML(item.caption), \"</b>\", \"<hr></hr>\", lang.escapeHTML(transformSnippetTooltip(item.snippet))].join(\"\");\n      }\n    }\n  };\n  var completers = [snippetCompleter, textCompleter, keyWordCompleter];\n\n  exports.setCompleters = function (val) {\n    completers.length = 0;\n    if (val) completers.push.apply(completers, val);\n  };\n\n  exports.addCompleter = function (completer) {\n    completers.push(completer);\n  };\n\n  exports.textCompleter = textCompleter;\n  exports.keyWordCompleter = keyWordCompleter;\n  exports.snippetCompleter = snippetCompleter;\n  var expandSnippet = {\n    name: \"expandSnippet\",\n    exec: function (editor) {\n      return snippetManager.expandWithTab(editor);\n    },\n    bindKey: \"Tab\"\n  };\n\n  var onChangeMode = function (e, editor) {\n    loadSnippetsForMode(editor.session.$mode);\n  };\n\n  var loadSnippetsForMode = function (mode) {\n    if (typeof mode == \"string\") mode = config.$modes[mode];\n    if (!mode) return;\n    if (!snippetManager.files) snippetManager.files = {};\n    loadSnippetFile(mode.$id, mode.snippetFileId);\n    if (mode.modes) mode.modes.forEach(loadSnippetsForMode);\n  };\n\n  var loadSnippetFile = function (id, snippetFilePath) {\n    if (!snippetFilePath || !id || snippetManager.files[id]) return;\n    snippetManager.files[id] = {};\n    config.loadModule(snippetFilePath, function (m) {\n      if (!m) return;\n      snippetManager.files[id] = m;\n      if (!m.snippets && m.snippetText) m.snippets = snippetManager.parseSnippetFile(m.snippetText);\n      snippetManager.register(m.snippets || [], m.scope);\n\n      if (m.includeScopes) {\n        snippetManager.snippetMap[m.scope].includeScopes = m.includeScopes;\n        m.includeScopes.forEach(function (x) {\n          loadSnippetsForMode(\"ace/mode/\" + x);\n        });\n      }\n    });\n  };\n\n  var doLiveAutocomplete = function (e) {\n    var editor = e.editor;\n    var hasCompleter = editor.completer && editor.completer.activated;\n\n    if (e.command.name === \"backspace\") {\n      if (hasCompleter && !util.getCompletionPrefix(editor)) editor.completer.detach();\n    } else if (e.command.name === \"insertstring\") {\n      var prefix = util.getCompletionPrefix(editor);\n\n      if (prefix && !hasCompleter) {\n        var completer = Autocomplete.for(editor);\n        completer.autoInsert = false;\n        completer.showPopup(editor);\n      }\n    }\n  };\n\n  var Editor = require(\"../editor\").Editor;\n\n  require(\"../config\").defineOptions(Editor.prototype, \"editor\", {\n    enableBasicAutocompletion: {\n      set: function (val) {\n        if (val) {\n          if (!this.completers) this.completers = Array.isArray(val) ? val : completers;\n          this.commands.addCommand(Autocomplete.startCommand);\n        } else {\n          this.commands.removeCommand(Autocomplete.startCommand);\n        }\n      },\n      value: false\n    },\n    enableLiveAutocompletion: {\n      set: function (val) {\n        if (val) {\n          if (!this.completers) this.completers = Array.isArray(val) ? val : completers;\n          this.commands.on('afterExec', doLiveAutocomplete);\n        } else {\n          this.commands.removeListener('afterExec', doLiveAutocomplete);\n        }\n      },\n      value: false\n    },\n    enableSnippets: {\n      set: function (val) {\n        if (val) {\n          this.commands.addCommand(expandSnippet);\n          this.on(\"changeMode\", onChangeMode);\n          onChangeMode(null, this);\n        } else {\n          this.commands.removeCommand(expandSnippet);\n          this.off(\"changeMode\", onChangeMode);\n        }\n      },\n      value: false\n    }\n  });\n});\n\n(function () {\n  ace.require([\"ace/ext/language_tools\"], function (m) {\n    if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n      module.exports = m;\n    }\n  });\n})();","map":{"version":3,"names":["ace","define","require","exports","module","dom","oop","EventEmitter","lang","Range","RangeList","HashHandler","Tokenizer","clipboard","VARIABLES","CURRENT_WORD","editor","session","getTextRange","getWordRange","SELECTION","name","indentation","text","replace","CURRENT_LINE","getLine","getCursorPosition","row","PREV_LINE","LINE_INDEX","LINE_NUMBER","SOFT_TABS","getUseSoftTabs","TAB_SIZE","getTabSize","CLIPBOARD","getText","FILENAME","exec","FILEPATH","FILENAME_BASE","DIRECTORY","WORKSPACE_NAME","FULLNAME","BLOCK_COMMENT_START","mode","$mode","blockComment","start","BLOCK_COMMENT_END","end","LINE_COMMENT","lineCommentStart","CURRENT_YEAR","date","bind","year","CURRENT_YEAR_SHORT","CURRENT_MONTH","month","CURRENT_MONTH_NAME","CURRENT_MONTH_NAME_SHORT","CURRENT_DATE","day","CURRENT_DAY_NAME","weekday","CURRENT_DAY_NAME_SHORT","CURRENT_HOUR","hour","hour12","CURRENT_MINUTE","minute","CURRENT_SECOND","second","SELECTED_TEXT","dateFormat","str","Date","toLocaleString","length","SnippetManager","snippetMap","snippetNameMap","implement","getTokenizer","$tokenizer","createTokenizer","TabstopToken","substr","test","tabstopId","parseInt","escape","ch","formatMatcher","regex","onMatch","val","state","stack","ts","fmtString","guard","slice","flag","next","indexOf","shift","t","unshift","token","merge","snippetVar","choices","operator","split","map","value","formatString","expectElse","ifEnd","elseEnd","changeCase","local","formatStringVar","formatFunction","tokenizeTmSnippet","startState","getLineTokens","tokens","x","getVariableValue","variables","__","hasOwnProperty","tmStrFormat","fmt","re","RegExp","fmtTokens","_self","formatted","oldArgs","call","arguments","fmtParts","resolveVariables","gChangeCase","i","toUpperCase","toLowerCase","join","tmFormatFunction","snippet","result","afterNewLine","push","j","gotoNext","i1","insertSnippetForSelection","snippetText","cursor","line","tabString","getTabString","indentString","match","column","tabstops","forEach","p","id","index","parents","isNested","some","expanding","copyValue","copy","lastIndexOf","Object","keys","parentId","splice","apply","Math","max","concat","lines","range","getSelectionRange","tabstopManager","TabstopManager","selectionId","inVirtualSelectionMode","selection","addTabstops","insertSnippet","self","forEachSelection","keepOrder","tabNext","$getScope","scope","$id","pop","inlinePhp","c","getState","substring","getActiveScopes","scopes","includeScopes","expandWithTab","options","expandSnippetForSelection","before","after","snippets","findMatchingSnippet","dryRun","doc","removeInLine","replaceBefore","replaceAfter","M__","matchBefore","T__","matchAfter","content","snippetList","s","startRe","endRe","triggerRe","endTriggerRe","register","wrapRegexp","src","guardedRegexp","opening","addSnippet","old","unregister","prefix","tabTrigger","body","Array","isArray","trigger","escapeRegExp","endTrigger","endGuard","key","_signal","removeSnippet","nameMap","parseSnippetFile","list","m","JSON","parse","e","guardRe","getSnippetByName","prototype","$onChange","onChange","$onChangeSelection","delayedCall","onChangeSelection","schedule","$onChangeSession","onChangeSession","$onAfterExec","onAfterExec","attach","ranges","$openTabstops","selectedTabstop","on","commands","keyBinding","addKeyboardHandler","keyboardHandler","detach","removeTabstopMarkers","removeListener","removeKeyboardHandler","delta","isRemove","action","active","rangeList","$bias","parentActive","startIndex","pointIndex","endIndex","toRemove","removeRange","$inChange","getLength","getValue","updateLinkedFields","hasLinkedRanges","firstNonLinked","linked","original","snippetManager","command","readOnly","lead","anchor","isEmpty","containsLead","contains","containsAnchor","dir","min","selectTabstop","addTabstopMarkers","sel","multiSelect","toSingleRange","addRange","clone","fromOrientedRange","execCommand","matches","useLink","getOption","fromPoints","moveRelative","arg","dest","movePoint","tabstop","addList","markerId","addMarker","removeMarker","bindKeys","renderer","scrollCursorIntoView","point","diff","importCssString","Editor","expandSnippet","Renderer","VirtualRenderer","event","$singleLineEditor","el","$maxLines","setHighlightActiveLine","setShowPrintMargin","setShowGutter","setHighlightGutterLine","$mouseHandler","$focusTimeout","$highlightTagPending","AcePopup","parentNode","createElement","popup","appendChild","style","display","setStyle","setOption","noop","focus","$isFocused","$cursorLayer","restartTimer","element","opacity","$keepTextAreaAtCursor","highlight","$searchHighlight","clazz","pos","getDocumentPosition","moveToPosition","selectionMarker","stop","lastMouseEvent","hoverMarker","Infinity","setSelectOnHover","y","scrollTop","setRow","setHoverMarker","$pos","getRow","$textLayer","selected","childNodes","config","firstRow","selectedNode","removeCssClass","addCssClass","hideHoverMarker","suppressRedraw","_emit","getHoveredRow","addListener","container","data","bgTokenizer","$tokenizeRow","caption","addToken","className","type","lower","filterText","lastIndex","lastI","matchMask","sub","meta","message","$updateOnChange","$computeWidth","screenWidth","isOpen","isTopdown","autoSelect","setData","setValue","stringRepeat","getData","clearSelection","moveCursorTo","hide","show","lineHeight","topdownOnly","screenHeight","window","innerHeight","innerWidth","maxH","top","$borderSize","allowTopdown","$maxPixelHeight","bottom","left","offsetWidth","goTo","where","getTextLeftOffset","$padding","$imageSize","parForEach","array","fn","callback","completed","arLength","err","ID_REGEX","retrievePrecedingIdentifier","buf","reverse","retrieveFollowingIdentifier","getCompletionPrefix","completers","completer","identifierRegexps","identifierRegex","util","Autocomplete","autoInsert","exactMatch","gatherCompletionsId","blurListener","changeListener","mousedownListener","mousewheelListener","changeTimer","updateCompletions","tooltipTimer","updateDocTooltip","$init","document","documentElement","insertMatch","getPopup","openPopup","keepPopupPosition","completions","filtered","setTheme","getTheme","setFontSize","getFontSize","layerConfig","getPixelPosition","base","rect","getBoundingClientRect","offset","scrollLeft","gutterWidth","cancel","off","hideDocTooltip","activated","activeElement","textInput","getElement","fromTooltip","relatedTarget","tooltipNode","startOperation","getAllRanges","remove","endOperation","deleteSuffix","gotoPageUp","gotoPageDown","gatherCompletions","getSession","createAnchor","$insertRight","total","getCompletions","results","finished","showPopup","setFilter","FilteredList","_id","detachIfFinished","processResults","isImmediate","immediateResults","cancelContextMenu","all","getDocTooltip","docText","docHTML","showDocTooltip","item","margin","pointerEvents","tabIndex","onblur","onclick","onTooltipClick","innerHTML","textContent","right","offsetTop","offsetHeight","isFocused","removeChild","a","target","nodeName","href","rel","destroy","for","get","$shared","$sharedInstance","once","startCommand","bindKey","filterCompletions","sort","b","$score","localeCompare","prev","filter","items","needle","upper","loop","penalty","distance","fullMatchIndex","i2","score","splitRegex","getWordIndex","textBefore","wordDistance","prefixPos","words","wordScores","create","currentWord","word","idx","abs","wordScore","wordList","textCompleter","keyWordCompleter","transformSnippetTooltip","record","_","p1","p2","p3","snippetCompleter","getTokenAt","escapeHTML","setCompleters","addCompleter","onChangeMode","loadSnippetsForMode","$modes","files","loadSnippetFile","snippetFileId","modes","snippetFilePath","loadModule","doLiveAutocomplete","hasCompleter","defineOptions","enableBasicAutocompletion","set","addCommand","removeCommand","enableLiveAutocompletion","enableSnippets"],"sources":["C:/Users/PRIYANK TRIPATHI/Desktop/webd/ide_front/ide_front/node_modules/ace-builds/src-noconflict/ext-language_tools.js"],"sourcesContent":["ace.define(\"ace/snippets\",[\"require\",\"exports\",\"module\",\"ace/lib/dom\",\"ace/lib/oop\",\"ace/lib/event_emitter\",\"ace/lib/lang\",\"ace/range\",\"ace/range_list\",\"ace/keyboard/hash_handler\",\"ace/tokenizer\",\"ace/clipboard\",\"ace/editor\"], function(require, exports, module) {\n\"use strict\";\nvar dom = require(\"./lib/dom\");\nvar oop = require(\"./lib/oop\");\nvar EventEmitter = require(\"./lib/event_emitter\").EventEmitter;\nvar lang = require(\"./lib/lang\");\nvar Range = require(\"./range\").Range;\nvar RangeList = require(\"./range_list\").RangeList;\nvar HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\nvar Tokenizer = require(\"./tokenizer\").Tokenizer;\nvar clipboard = require(\"./clipboard\");\n\nvar VARIABLES = {\n    CURRENT_WORD: function(editor) {\n        return editor.session.getTextRange(editor.session.getWordRange());\n    },\n    SELECTION: function(editor, name, indentation) {\n        var text = editor.session.getTextRange();\n        if (indentation)\n            return text.replace(/\\n\\r?([ \\t]*\\S)/g, \"\\n\" + indentation + \"$1\");\n        return text;\n    },\n    CURRENT_LINE: function(editor) {\n        return editor.session.getLine(editor.getCursorPosition().row);\n    },\n    PREV_LINE: function(editor) {\n        return editor.session.getLine(editor.getCursorPosition().row - 1);\n    },\n    LINE_INDEX: function(editor) {\n        return editor.getCursorPosition().row;\n    },\n    LINE_NUMBER: function(editor) {\n        return editor.getCursorPosition().row + 1;\n    },\n    SOFT_TABS: function(editor) {\n        return editor.session.getUseSoftTabs() ? \"YES\" : \"NO\";\n    },\n    TAB_SIZE: function(editor) {\n        return editor.session.getTabSize();\n    },\n    CLIPBOARD: function(editor) {\n        return clipboard.getText && clipboard.getText();\n    },\n    FILENAME: function(editor) {\n        return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0];\n    },\n    FILENAME_BASE: function(editor) {\n        return /[^/\\\\]*$/.exec(this.FILEPATH(editor))[0].replace(/\\.[^.]*$/, \"\");\n    },\n    DIRECTORY: function(editor) {\n        return this.FILEPATH(editor).replace(/[^/\\\\]*$/, \"\");\n    },\n    FILEPATH: function(editor) { return \"/not implemented.txt\"; },\n    WORKSPACE_NAME: function() { return \"Unknown\"; },\n    FULLNAME: function() { return \"Unknown\"; },\n    BLOCK_COMMENT_START: function(editor) {\n        var mode = editor.session.$mode || {};\n        return mode.blockComment && mode.blockComment.start || \"\";\n    },\n    BLOCK_COMMENT_END: function(editor) {\n        var mode = editor.session.$mode || {};\n        return mode.blockComment && mode.blockComment.end || \"\";\n    },\n    LINE_COMMENT: function(editor) {\n        var mode = editor.session.$mode || {};\n        return mode.lineCommentStart || \"\";\n    },\n    CURRENT_YEAR: date.bind(null, {year: \"numeric\"}),\n    CURRENT_YEAR_SHORT: date.bind(null, {year: \"2-digit\"}),\n    CURRENT_MONTH: date.bind(null, {month: \"numeric\"}),\n    CURRENT_MONTH_NAME: date.bind(null, {month: \"long\"}),\n    CURRENT_MONTH_NAME_SHORT: date.bind(null, {month: \"short\"}),\n    CURRENT_DATE: date.bind(null, {day: \"2-digit\"}),\n    CURRENT_DAY_NAME: date.bind(null, {weekday: \"long\"}),\n    CURRENT_DAY_NAME_SHORT: date.bind(null, {weekday: \"short\"}),\n    CURRENT_HOUR: date.bind(null, {hour: \"2-digit\", hour12: false}),\n    CURRENT_MINUTE: date.bind(null, {minute: \"2-digit\"}),\n    CURRENT_SECOND: date.bind(null, {second: \"2-digit\"})\n};\n\nVARIABLES.SELECTED_TEXT = VARIABLES.SELECTION;\n\nfunction date(dateFormat) {\n    var str = new Date().toLocaleString(\"en-us\", dateFormat);\n    return str.length == 1 ? \"0\" + str : str;\n}\n\nvar SnippetManager = function() {\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n};\n\n(function() {\n    oop.implement(this, EventEmitter);\n    \n    this.getTokenizer = function() {\n        return SnippetManager.$tokenizer || this.createTokenizer();\n    };\n    \n    this.createTokenizer = function() {\n        function TabstopToken(str) {\n            str = str.substr(1);\n            if (/^\\d+$/.test(str))\n                return [{tabstopId: parseInt(str, 10)}];\n            return [{text: str}];\n        }\n        function escape(ch) {\n            return \"(?:[^\\\\\\\\\" + ch + \"]|\\\\\\\\.)\";\n        }\n        var formatMatcher = {\n            regex: \"/(\" + escape(\"/\") + \"+)/\", \n            onMatch: function(val, state, stack) {\n                var ts = stack[0];\n                ts.fmtString = true;\n                ts.guard = val.slice(1, -1);\n                ts.flag = \"\";\n                return \"\";\n            },\n            next: \"formatString\"\n        };\n        \n        SnippetManager.$tokenizer = new Tokenizer({\n            start: [\n                {regex: /\\\\./, onMatch: function(val, state, stack) {\n                    var ch = val[1];\n                    if (ch == \"}\" && stack.length) {\n                        val = ch;\n                    } else if (\"`$\\\\\".indexOf(ch) != -1) {\n                        val = ch;\n                    }\n                    return [val];\n                }},\n                {regex: /}/, onMatch: function(val, state, stack) {\n                    return [stack.length ? stack.shift() : val];\n                }},\n                {regex: /\\$(?:\\d+|\\w+)/, onMatch: TabstopToken},\n                {regex: /\\$\\{[\\dA-Z_a-z]+/, onMatch: function(str, state, stack) {\n                    var t = TabstopToken(str.substr(1));\n                    stack.unshift(t[0]);\n                    return t;\n                }, next: \"snippetVar\"},\n                {regex: /\\n/, token: \"newline\", merge: false}\n            ],\n            snippetVar: [\n                {regex: \"\\\\|\" + escape(\"\\\\|\") + \"*\\\\|\", onMatch: function(val, state, stack) {\n                    var choices = val.slice(1, -1).replace(/\\\\[,|\\\\]|,/g, function(operator) {\n                        return operator.length == 2 ? operator[1] : \"\\x00\";\n                    }).split(\"\\x00\").map(function(value){\n                        return {value: value};\n                    });\n                    stack[0].choices = choices;\n                    return [choices[0]];\n                }, next: \"start\"},\n                formatMatcher,\n                {regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\", token: \"\", next: \"start\"}\n            ],\n            formatString: [\n                {regex: /:/, onMatch: function(val, state, stack) {\n                    if (stack.length && stack[0].expectElse) {\n                        stack[0].expectElse = false;\n                        stack[0].ifEnd = {elseEnd: stack[0]};\n                        return [stack[0].ifEnd];\n                    }\n                    return \":\";\n                }},\n                {regex: /\\\\./, onMatch: function(val, state, stack) {\n                    var ch = val[1];\n                    if (ch == \"}\" && stack.length)\n                        val = ch;\n                    else if (\"`$\\\\\".indexOf(ch) != -1)\n                        val = ch;\n                    else if (ch == \"n\")\n                        val = \"\\n\";\n                    else if (ch == \"t\")\n                        val = \"\\t\";\n                    else if (\"ulULE\".indexOf(ch) != -1)\n                        val = {changeCase: ch, local: ch > \"a\"};\n                    return [val];\n                }},\n                {regex: \"/\\\\w*}\", onMatch: function(val, state, stack) {\n                    var next = stack.shift();\n                    if (next)\n                        next.flag = val.slice(1, -1);\n                    this.next = next && next.tabstopId ? \"start\" : \"\";\n                    return [next || val];\n                }, next: \"start\"},\n                {regex: /\\$(?:\\d+|\\w+)/, onMatch: function(val, state, stack) {\n                    return [{text: val.slice(1)}];\n                }},\n                {regex: /\\${\\w+/, onMatch: function(val, state, stack) {\n                    var token = {text: val.slice(2)};\n                    stack.unshift(token);\n                    return [token];\n                }, next: \"formatStringVar\"},\n                {regex: /\\n/, token: \"newline\", merge: false},\n                {regex: /}/, onMatch: function(val, state, stack) {\n                    var next = stack.shift();\n                    this.next = next && next.tabstopId ? \"start\" : \"\";\n                    return [next || val];\n                }, next: \"start\"}\n            ],\n            formatStringVar: [\n                {regex: /:\\/\\w+}/, onMatch: function(val, state, stack) {\n                    var ts = stack[0];\n                    ts.formatFunction = val.slice(2, -1);\n                    return [stack.shift()];\n                }, next: \"formatString\"},\n                formatMatcher,\n                {regex: /:[\\?\\-+]?/, onMatch: function(val, state, stack) {\n                    if (val[1] == \"+\")\n                        stack[0].ifEnd = stack[0];\n                    if (val[1] == \"?\")\n                        stack[0].expectElse = true;\n                }, next: \"formatString\"},\n                {regex: \"([^:}\\\\\\\\]|\\\\\\\\.)*:?\", token: \"\", next: \"formatString\"}\n            ]\n        });\n        return SnippetManager.$tokenizer;\n    };\n\n    this.tokenizeTmSnippet = function(str, startState) {\n        return this.getTokenizer().getLineTokens(str, startState).tokens.map(function(x) {\n            return x.value || x;\n        });\n    };\n    \n    this.getVariableValue = function(editor, name, indentation) {\n        if (/^\\d+$/.test(name))\n            return (this.variables.__ || {})[name] || \"\";\n        if (/^[A-Z]\\d+$/.test(name))\n            return (this.variables[name[0] + \"__\"] || {})[name.substr(1)] || \"\";\n        \n        name = name.replace(/^TM_/, \"\");\n        if (!this.variables.hasOwnProperty(name))\n            return \"\";\n        var value = this.variables[name];\n        if (typeof value == \"function\")\n            value = this.variables[name](editor, name, indentation);\n        return value == null ? \"\" : value;\n    };\n    \n    this.variables = VARIABLES;\n    this.tmStrFormat = function(str, ch, editor) {\n        if (!ch.fmt) return str;\n        var flag = ch.flag || \"\";\n        var re = ch.guard;\n        re = new RegExp(re, flag.replace(/[^gim]/g, \"\"));\n        var fmtTokens = typeof ch.fmt == \"string\" ? this.tokenizeTmSnippet(ch.fmt, \"formatString\") : ch.fmt;\n        var _self = this;\n        var formatted = str.replace(re, function() {\n            var oldArgs = _self.variables.__;\n            _self.variables.__ = [].slice.call(arguments);\n            var fmtParts = _self.resolveVariables(fmtTokens, editor);\n            var gChangeCase = \"E\";\n            for (var i  = 0; i < fmtParts.length; i++) {\n                var ch = fmtParts[i];\n                if (typeof ch == \"object\") {\n                    fmtParts[i] = \"\";\n                    if (ch.changeCase && ch.local) {\n                        var next = fmtParts[i + 1];\n                        if (next && typeof next == \"string\") {\n                            if (ch.changeCase == \"u\")\n                                fmtParts[i] = next[0].toUpperCase();\n                            else\n                                fmtParts[i] = next[0].toLowerCase();\n                            fmtParts[i + 1] = next.substr(1);\n                        }\n                    } else if (ch.changeCase) {\n                        gChangeCase = ch.changeCase;\n                    }\n                } else if (gChangeCase == \"U\") {\n                    fmtParts[i] = ch.toUpperCase();\n                } else if (gChangeCase == \"L\") {\n                    fmtParts[i] = ch.toLowerCase();\n                }\n            }\n            _self.variables.__ = oldArgs;\n            return fmtParts.join(\"\");\n        });\n        return formatted;\n    };\n    \n    this.tmFormatFunction = function(str, ch, editor) {\n        if (ch.formatFunction == \"upcase\")\n            return str.toUpperCase();\n        if (ch.formatFunction == \"downcase\")\n            return str.toLowerCase();\n        return str;\n    };\n\n    this.resolveVariables = function(snippet, editor) {\n        var result = [];\n        var indentation = \"\";\n        var afterNewLine = true;\n        for (var i = 0; i < snippet.length; i++) {\n            var ch = snippet[i];\n            if (typeof ch == \"string\") {\n                result.push(ch);\n                if (ch == \"\\n\") {\n                    afterNewLine = true;\n                    indentation = \"\";\n                }\n                else if (afterNewLine) {\n                    indentation = /^\\t*/.exec(ch)[0];\n                    afterNewLine = /\\S/.test(ch);\n                }\n                continue;\n            }\n            if (!ch)  continue;\n            afterNewLine = false;\n            \n            if (ch.fmtString) {\n                var j = snippet.indexOf(ch, i + 1);\n                if (j == -1) j = snippet.length;\n                ch.fmt = snippet.slice(i + 1, j);\n                i = j;\n            }\n            \n            if (ch.text) {\n                var value = this.getVariableValue(editor, ch.text, indentation) + \"\";\n                if (ch.fmtString)\n                    value = this.tmStrFormat(value, ch, editor);\n                if (ch.formatFunction)\n                    value = this.tmFormatFunction(value, ch, editor);\n                \n                if (value && !ch.ifEnd) {\n                    result.push(value);\n                    gotoNext(ch);\n                } else if (!value && ch.ifEnd) {\n                    gotoNext(ch.ifEnd);\n                }\n            } else if (ch.elseEnd) {\n                gotoNext(ch.elseEnd);\n            } else if (ch.tabstopId != null) {\n                result.push(ch);\n            } else if (ch.changeCase != null) {\n                result.push(ch);\n            }\n        }\n        function gotoNext(ch) {\n            var i1 = snippet.indexOf(ch, i + 1);\n            if (i1 != -1)\n                i = i1;\n        }\n        return result;\n    };\n\n    this.insertSnippetForSelection = function(editor, snippetText) {\n        var cursor = editor.getCursorPosition();\n        var line = editor.session.getLine(cursor.row);\n        var tabString = editor.session.getTabString();\n        var indentString = line.match(/^\\s*/)[0];\n        \n        if (cursor.column < indentString.length)\n            indentString = indentString.slice(0, cursor.column);\n\n        snippetText = snippetText.replace(/\\r/g, \"\");\n        var tokens = this.tokenizeTmSnippet(snippetText);\n        tokens = this.resolveVariables(tokens, editor);\n        tokens = tokens.map(function(x) {\n            if (x == \"\\n\")\n                return x + indentString;\n            if (typeof x == \"string\")\n                return x.replace(/\\t/g, tabString);\n            return x;\n        });\n        var tabstops = [];\n        tokens.forEach(function(p, i) {\n            if (typeof p != \"object\")\n                return;\n            var id = p.tabstopId;\n            var ts = tabstops[id];\n            if (!ts) {\n                ts = tabstops[id] = [];\n                ts.index = id;\n                ts.value = \"\";\n                ts.parents = {};\n            }\n            if (ts.indexOf(p) !== -1)\n                return;\n            if (p.choices && !ts.choices)\n                ts.choices = p.choices;\n            ts.push(p);\n            var i1 = tokens.indexOf(p, i + 1);\n            if (i1 === -1)\n                return;\n\n            var value = tokens.slice(i + 1, i1);\n            var isNested = value.some(function(t) {return typeof t === \"object\";});\n            if (isNested && !ts.value) {\n                ts.value = value;\n            } else if (value.length && (!ts.value || typeof ts.value !== \"string\")) {\n                ts.value = value.join(\"\");\n            }\n        });\n        tabstops.forEach(function(ts) {ts.length = 0;});\n        var expanding = {};\n        function copyValue(val) {\n            var copy = [];\n            for (var i = 0; i < val.length; i++) {\n                var p = val[i];\n                if (typeof p == \"object\") {\n                    if (expanding[p.tabstopId])\n                        continue;\n                    var j = val.lastIndexOf(p, i - 1);\n                    p = copy[j] || {tabstopId: p.tabstopId};\n                }\n                copy[i] = p;\n            }\n            return copy;\n        }\n        for (var i = 0; i < tokens.length; i++) {\n            var p = tokens[i];\n            if (typeof p != \"object\")\n                continue;\n            var id = p.tabstopId;\n            var ts = tabstops[id];\n            var i1 = tokens.indexOf(p, i + 1);\n            if (expanding[id]) {\n                if (expanding[id] === p) {\n                    delete expanding[id];\n                    Object.keys(expanding).forEach(function(parentId) {\n                        ts.parents[parentId] = true;\n                    });\n                }\n                continue;\n            }\n            expanding[id] = p;\n            var value = ts.value;\n            if (typeof value !== \"string\")\n                value = copyValue(value);\n            else if (p.fmt)\n                value = this.tmStrFormat(value, p, editor);\n            tokens.splice.apply(tokens, [i + 1, Math.max(0, i1 - i)].concat(value, p));\n\n            if (ts.indexOf(p) === -1)\n                ts.push(p);\n        }\n        var row = 0, column = 0;\n        var text = \"\";\n        tokens.forEach(function(t) {\n            if (typeof t === \"string\") {\n                var lines = t.split(\"\\n\");\n                if (lines.length > 1){\n                    column = lines[lines.length - 1].length;\n                    row += lines.length - 1;\n                } else\n                    column += t.length;\n                text += t;\n            } else if (t) {\n                if (!t.start)\n                    t.start = {row: row, column: column};\n                else\n                    t.end = {row: row, column: column};\n            }\n        });\n        var range = editor.getSelectionRange();\n        var end = editor.session.replace(range, text);\n\n        var tabstopManager = new TabstopManager(editor);\n        var selectionId = editor.inVirtualSelectionMode && editor.selection.index;\n        tabstopManager.addTabstops(tabstops, range.start, end, selectionId);\n    };\n    \n    this.insertSnippet = function(editor, snippetText) {\n        var self = this;\n        if (editor.inVirtualSelectionMode)\n            return self.insertSnippetForSelection(editor, snippetText);\n        \n        editor.forEachSelection(function() {\n            self.insertSnippetForSelection(editor, snippetText);\n        }, null, {keepOrder: true});\n        \n        if (editor.tabstopManager)\n            editor.tabstopManager.tabNext();\n    };\n\n    this.$getScope = function(editor) {\n        var scope = editor.session.$mode.$id || \"\";\n        scope = scope.split(\"/\").pop();\n        if (scope === \"html\" || scope === \"php\") {\n            if (scope === \"php\" && !editor.session.$mode.inlinePhp) \n                scope = \"html\";\n            var c = editor.getCursorPosition();\n            var state = editor.session.getState(c.row);\n            if (typeof state === \"object\") {\n                state = state[0];\n            }\n            if (state.substring) {\n                if (state.substring(0, 3) == \"js-\")\n                    scope = \"javascript\";\n                else if (state.substring(0, 4) == \"css-\")\n                    scope = \"css\";\n                else if (state.substring(0, 4) == \"php-\")\n                    scope = \"php\";\n            }\n        }\n        \n        return scope;\n    };\n\n    this.getActiveScopes = function(editor) {\n        var scope = this.$getScope(editor);\n        var scopes = [scope];\n        var snippetMap = this.snippetMap;\n        if (snippetMap[scope] && snippetMap[scope].includeScopes) {\n            scopes.push.apply(scopes, snippetMap[scope].includeScopes);\n        }\n        scopes.push(\"_\");\n        return scopes;\n    };\n\n    this.expandWithTab = function(editor, options) {\n        var self = this;\n        var result = editor.forEachSelection(function() {\n            return self.expandSnippetForSelection(editor, options);\n        }, null, {keepOrder: true});\n        if (result && editor.tabstopManager)\n            editor.tabstopManager.tabNext();\n        return result;\n    };\n    \n    this.expandSnippetForSelection = function(editor, options) {\n        var cursor = editor.getCursorPosition();\n        var line = editor.session.getLine(cursor.row);\n        var before = line.substring(0, cursor.column);\n        var after = line.substr(cursor.column);\n\n        var snippetMap = this.snippetMap;\n        var snippet;\n        this.getActiveScopes(editor).some(function(scope) {\n            var snippets = snippetMap[scope];\n            if (snippets)\n                snippet = this.findMatchingSnippet(snippets, before, after);\n            return !!snippet;\n        }, this);\n        if (!snippet)\n            return false;\n        if (options && options.dryRun)\n            return true;\n        editor.session.doc.removeInLine(cursor.row,\n            cursor.column - snippet.replaceBefore.length,\n            cursor.column + snippet.replaceAfter.length\n        );\n\n        this.variables.M__ = snippet.matchBefore;\n        this.variables.T__ = snippet.matchAfter;\n        this.insertSnippetForSelection(editor, snippet.content);\n\n        this.variables.M__ = this.variables.T__ = null;\n        return true;\n    };\n\n    this.findMatchingSnippet = function(snippetList, before, after) {\n        for (var i = snippetList.length; i--;) {\n            var s = snippetList[i];\n            if (s.startRe && !s.startRe.test(before))\n                continue;\n            if (s.endRe && !s.endRe.test(after))\n                continue;\n            if (!s.startRe && !s.endRe)\n                continue;\n\n            s.matchBefore = s.startRe ? s.startRe.exec(before) : [\"\"];\n            s.matchAfter = s.endRe ? s.endRe.exec(after) : [\"\"];\n            s.replaceBefore = s.triggerRe ? s.triggerRe.exec(before)[0] : \"\";\n            s.replaceAfter = s.endTriggerRe ? s.endTriggerRe.exec(after)[0] : \"\";\n            return s;\n        }\n    };\n\n    this.snippetMap = {};\n    this.snippetNameMap = {};\n    this.register = function(snippets, scope) {\n        var snippetMap = this.snippetMap;\n        var snippetNameMap = this.snippetNameMap;\n        var self = this;\n        \n        if (!snippets) \n            snippets = [];\n        \n        function wrapRegexp(src) {\n            if (src && !/^\\^?\\(.*\\)\\$?$|^\\\\b$/.test(src))\n                src = \"(?:\" + src + \")\";\n\n            return src || \"\";\n        }\n        function guardedRegexp(re, guard, opening) {\n            re = wrapRegexp(re);\n            guard = wrapRegexp(guard);\n            if (opening) {\n                re = guard + re;\n                if (re && re[re.length - 1] != \"$\")\n                    re = re + \"$\";\n            } else {\n                re = re + guard;\n                if (re && re[0] != \"^\")\n                    re = \"^\" + re;\n            }\n            return new RegExp(re);\n        }\n\n        function addSnippet(s) {\n            if (!s.scope)\n                s.scope = scope || \"_\";\n            scope = s.scope;\n            if (!snippetMap[scope]) {\n                snippetMap[scope] = [];\n                snippetNameMap[scope] = {};\n            }\n\n            var map = snippetNameMap[scope];\n            if (s.name) {\n                var old = map[s.name];\n                if (old)\n                    self.unregister(old);\n                map[s.name] = s;\n            }\n            snippetMap[scope].push(s);\n\n            if (s.prefix)\n                s.tabTrigger = s.prefix;\n\n            if (!s.content && s.body)\n                s.content = Array.isArray(s.body) ? s.body.join(\"\\n\") : s.body;\n\n            if (s.tabTrigger && !s.trigger) {\n                if (!s.guard && /^\\w/.test(s.tabTrigger))\n                    s.guard = \"\\\\b\";\n                s.trigger = lang.escapeRegExp(s.tabTrigger);\n            }\n            \n            if (!s.trigger && !s.guard && !s.endTrigger && !s.endGuard)\n                return;\n            \n            s.startRe = guardedRegexp(s.trigger, s.guard, true);\n            s.triggerRe = new RegExp(s.trigger);\n\n            s.endRe = guardedRegexp(s.endTrigger, s.endGuard, true);\n            s.endTriggerRe = new RegExp(s.endTrigger);\n        }\n\n        if (Array.isArray(snippets)) {\n            snippets.forEach(addSnippet);\n        } else {\n            Object.keys(snippets).forEach(function(key) {\n                addSnippet(snippets[key]);\n            });\n        }\n        \n        this._signal(\"registerSnippets\", {scope: scope});\n    };\n    this.unregister = function(snippets, scope) {\n        var snippetMap = this.snippetMap;\n        var snippetNameMap = this.snippetNameMap;\n\n        function removeSnippet(s) {\n            var nameMap = snippetNameMap[s.scope||scope];\n            if (nameMap && nameMap[s.name]) {\n                delete nameMap[s.name];\n                var map = snippetMap[s.scope||scope];\n                var i = map && map.indexOf(s);\n                if (i >= 0)\n                    map.splice(i, 1);\n            }\n        }\n        if (snippets.content)\n            removeSnippet(snippets);\n        else if (Array.isArray(snippets))\n            snippets.forEach(removeSnippet);\n    };\n    this.parseSnippetFile = function(str) {\n        str = str.replace(/\\r/g, \"\");\n        var list = [], snippet = {};\n        var re = /^#.*|^({[\\s\\S]*})\\s*$|^(\\S+) (.*)$|^((?:\\n*\\t.*)+)/gm;\n        var m;\n        while (m = re.exec(str)) {\n            if (m[1]) {\n                try {\n                    snippet = JSON.parse(m[1]);\n                    list.push(snippet);\n                } catch (e) {}\n            } if (m[4]) {\n                snippet.content = m[4].replace(/^\\t/gm, \"\");\n                list.push(snippet);\n                snippet = {};\n            } else {\n                var key = m[2], val = m[3];\n                if (key == \"regex\") {\n                    var guardRe = /\\/((?:[^\\/\\\\]|\\\\.)*)|$/g;\n                    snippet.guard = guardRe.exec(val)[1];\n                    snippet.trigger = guardRe.exec(val)[1];\n                    snippet.endTrigger = guardRe.exec(val)[1];\n                    snippet.endGuard = guardRe.exec(val)[1];\n                } else if (key == \"snippet\") {\n                    snippet.tabTrigger = val.match(/^\\S*/)[0];\n                    if (!snippet.name)\n                        snippet.name = val;\n                } else if (key) {\n                    snippet[key] = val;\n                }\n            }\n        }\n        return list;\n    };\n    this.getSnippetByName = function(name, editor) {\n        var snippetMap = this.snippetNameMap;\n        var snippet;\n        this.getActiveScopes(editor).some(function(scope) {\n            var snippets = snippetMap[scope];\n            if (snippets)\n                snippet = snippets[name];\n            return !!snippet;\n        }, this);\n        return snippet;\n    };\n\n}).call(SnippetManager.prototype);\n\n\nvar TabstopManager = function(editor) {\n    if (editor.tabstopManager)\n        return editor.tabstopManager;\n    editor.tabstopManager = this;\n    this.$onChange = this.onChange.bind(this);\n    this.$onChangeSelection = lang.delayedCall(this.onChangeSelection.bind(this)).schedule;\n    this.$onChangeSession = this.onChangeSession.bind(this);\n    this.$onAfterExec = this.onAfterExec.bind(this);\n    this.attach(editor);\n};\n(function() {\n    this.attach = function(editor) {\n        this.index = 0;\n        this.ranges = [];\n        this.tabstops = [];\n        this.$openTabstops = null;\n        this.selectedTabstop = null;\n\n        this.editor = editor;\n        this.editor.on(\"change\", this.$onChange);\n        this.editor.on(\"changeSelection\", this.$onChangeSelection);\n        this.editor.on(\"changeSession\", this.$onChangeSession);\n        this.editor.commands.on(\"afterExec\", this.$onAfterExec);\n        this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n    };\n    this.detach = function() {\n        this.tabstops.forEach(this.removeTabstopMarkers, this);\n        this.ranges = null;\n        this.tabstops = null;\n        this.selectedTabstop = null;\n        this.editor.removeListener(\"change\", this.$onChange);\n        this.editor.removeListener(\"changeSelection\", this.$onChangeSelection);\n        this.editor.removeListener(\"changeSession\", this.$onChangeSession);\n        this.editor.commands.removeListener(\"afterExec\", this.$onAfterExec);\n        this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n        this.editor.tabstopManager = null;\n        this.editor = null;\n    };\n\n    this.onChange = function(delta) {\n        var isRemove = delta.action[0] == \"r\";\n        var selectedTabstop = this.selectedTabstop || {};\n        var parents = selectedTabstop.parents || {};\n        var tabstops = (this.tabstops || []).slice();\n        for (var i = 0; i < tabstops.length; i++) {\n            var ts = tabstops[i];\n            var active = ts == selectedTabstop || parents[ts.index];\n            ts.rangeList.$bias = active ? 0 : 1;\n            \n            if (delta.action == \"remove\" && ts !== selectedTabstop) {\n                var parentActive = ts.parents && ts.parents[selectedTabstop.index];\n                var startIndex = ts.rangeList.pointIndex(delta.start, parentActive);\n                startIndex = startIndex < 0 ? -startIndex - 1 : startIndex + 1;\n                var endIndex = ts.rangeList.pointIndex(delta.end, parentActive);\n                endIndex = endIndex < 0 ? -endIndex - 1 : endIndex - 1;\n                var toRemove = ts.rangeList.ranges.slice(startIndex, endIndex);\n                for (var j = 0; j < toRemove.length; j++)\n                    this.removeRange(toRemove[j]);\n            }\n            ts.rangeList.$onChange(delta);\n        }\n        var session = this.editor.session;\n        if (!this.$inChange && isRemove && session.getLength() == 1 && !session.getValue())\n            this.detach();\n    };\n    this.updateLinkedFields = function() {\n        var ts = this.selectedTabstop;\n        if (!ts || !ts.hasLinkedRanges || !ts.firstNonLinked)\n            return;\n        this.$inChange = true;\n        var session = this.editor.session;\n        var text = session.getTextRange(ts.firstNonLinked);\n        for (var i = 0; i < ts.length; i++) {\n            var range = ts[i];\n            if (!range.linked)\n                continue;\n            var original = range.original;\n            var fmt = exports.snippetManager.tmStrFormat(text, original, this.editor);\n            session.replace(range, fmt);\n        }\n        this.$inChange = false;\n    };\n    this.onAfterExec = function(e) {\n        if (e.command && !e.command.readOnly)\n            this.updateLinkedFields();\n    };\n    this.onChangeSelection = function() {\n        if (!this.editor)\n            return;\n        var lead = this.editor.selection.lead;\n        var anchor = this.editor.selection.anchor;\n        var isEmpty = this.editor.selection.isEmpty();\n        for (var i = 0; i < this.ranges.length; i++) {\n            if (this.ranges[i].linked)\n                continue;\n            var containsLead = this.ranges[i].contains(lead.row, lead.column);\n            var containsAnchor = isEmpty || this.ranges[i].contains(anchor.row, anchor.column);\n            if (containsLead && containsAnchor)\n                return;\n        }\n        this.detach();\n    };\n    this.onChangeSession = function() {\n        this.detach();\n    };\n    this.tabNext = function(dir) {\n        var max = this.tabstops.length;\n        var index = this.index + (dir || 1);\n        index = Math.min(Math.max(index, 1), max);\n        if (index == max)\n            index = 0;\n        this.selectTabstop(index);\n        if (index === 0)\n            this.detach();\n    };\n    this.selectTabstop = function(index) {\n        this.$openTabstops = null;\n        var ts = this.tabstops[this.index];\n        if (ts)\n            this.addTabstopMarkers(ts);\n        this.index = index;\n        ts = this.tabstops[this.index];\n        if (!ts || !ts.length)\n            return;\n        \n        this.selectedTabstop = ts;\n        var range = ts.firstNonLinked || ts;\n        if (ts.choices) range.cursor = range.start;\n        if (!this.editor.inVirtualSelectionMode) {\n            var sel = this.editor.multiSelect;\n            sel.toSingleRange(range);\n            for (var i = 0; i < ts.length; i++) {\n                if (ts.hasLinkedRanges && ts[i].linked)\n                    continue;\n                sel.addRange(ts[i].clone(), true);\n            }\n        } else {\n            this.editor.selection.fromOrientedRange(range);\n        }\n        \n        this.editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n        if (this.selectedTabstop && this.selectedTabstop.choices)\n            this.editor.execCommand(\"startAutocomplete\", {matches: this.selectedTabstop.choices});\n    };\n    this.addTabstops = function(tabstops, start, end) {\n        var useLink = this.useLink || !this.editor.getOption(\"enableMultiselect\");\n        \n        if (!this.$openTabstops)\n            this.$openTabstops = [];\n        if (!tabstops[0]) {\n            var p = Range.fromPoints(end, end);\n            moveRelative(p.start, start);\n            moveRelative(p.end, start);\n            tabstops[0] = [p];\n            tabstops[0].index = 0;\n        }\n\n        var i = this.index;\n        var arg = [i + 1, 0];\n        var ranges = this.ranges;\n        tabstops.forEach(function(ts, index) {\n            var dest = this.$openTabstops[index] || ts;\n            \n            for (var i = 0; i < ts.length; i++) {\n                var p = ts[i];\n                var range = Range.fromPoints(p.start, p.end || p.start);\n                movePoint(range.start, start);\n                movePoint(range.end, start);\n                range.original = p;\n                range.tabstop = dest;\n                ranges.push(range);\n                if (dest != ts)\n                    dest.unshift(range);\n                else\n                    dest[i] = range;\n                if (p.fmtString || (dest.firstNonLinked && useLink)) {\n                    range.linked = true;\n                    dest.hasLinkedRanges = true;\n                } else if (!dest.firstNonLinked)\n                    dest.firstNonLinked = range;\n            }\n            if (!dest.firstNonLinked)\n                dest.hasLinkedRanges = false;\n            if (dest === ts) {\n                arg.push(dest);\n                this.$openTabstops[index] = dest;\n            }\n            this.addTabstopMarkers(dest);\n            dest.rangeList = dest.rangeList || new RangeList();\n            dest.rangeList.$bias = 0;\n            dest.rangeList.addList(dest);\n        }, this);\n        \n        if (arg.length > 2) {\n            if (this.tabstops.length)\n                arg.push(arg.splice(2, 1)[0]);\n            this.tabstops.splice.apply(this.tabstops, arg);\n        }\n    };\n\n    this.addTabstopMarkers = function(ts) {\n        var session = this.editor.session;\n        ts.forEach(function(range) {\n            if  (!range.markerId)\n                range.markerId = session.addMarker(range, \"ace_snippet-marker\", \"text\");\n        });\n    };\n    this.removeTabstopMarkers = function(ts) {\n        var session = this.editor.session;\n        ts.forEach(function(range) {\n            session.removeMarker(range.markerId);\n            range.markerId = null;\n        });\n    };\n    this.removeRange = function(range) {\n        var i = range.tabstop.indexOf(range);\n        if (i != -1) range.tabstop.splice(i, 1);\n        i = this.ranges.indexOf(range);\n        if (i != -1) this.ranges.splice(i, 1);\n        i = range.tabstop.rangeList.ranges.indexOf(range);\n        if (i != -1) range.tabstop.splice(i, 1);\n        this.editor.session.removeMarker(range.markerId);\n        if (!range.tabstop.length) {\n            i = this.tabstops.indexOf(range.tabstop);\n            if (i != -1)\n                this.tabstops.splice(i, 1);\n            if (!this.tabstops.length)\n                this.detach();\n        }\n    };\n\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys({\n        \"Tab\": function(editor) {\n            if (exports.snippetManager && exports.snippetManager.expandWithTab(editor))\n                return;\n            editor.tabstopManager.tabNext(1);\n            editor.renderer.scrollCursorIntoView();\n        },\n        \"Shift-Tab\": function(editor) {\n            editor.tabstopManager.tabNext(-1);\n            editor.renderer.scrollCursorIntoView();\n        },\n        \"Esc\": function(editor) {\n            editor.tabstopManager.detach();\n        }\n    });\n}).call(TabstopManager.prototype);\n\n\n\nvar movePoint = function(point, diff) {\n    if (point.row == 0)\n        point.column += diff.column;\n    point.row += diff.row;\n};\n\nvar moveRelative = function(point, start) {\n    if (point.row == start.row)\n        point.column -= start.column;\n    point.row -= start.row;\n};\n\n\ndom.importCssString(\"\\\n.ace_snippet-marker {\\\n    -moz-box-sizing: border-box;\\\n    box-sizing: border-box;\\\n    background: rgba(194, 193, 208, 0.09);\\\n    border: 1px dotted rgba(211, 208, 235, 0.62);\\\n    position: absolute;\\\n}\", \"snippets.css\", false);\n\nexports.snippetManager = new SnippetManager();\n\n\nvar Editor = require(\"./editor\").Editor;\n(function() {\n    this.insertSnippet = function(content, options) {\n        return exports.snippetManager.insertSnippet(this, content, options);\n    };\n    this.expandSnippet = function(options) {\n        return exports.snippetManager.expandWithTab(this, options);\n    };\n}).call(Editor.prototype);\n\n});\n\nace.define(\"ace/autocomplete/popup\",[\"require\",\"exports\",\"module\",\"ace/virtual_renderer\",\"ace/editor\",\"ace/range\",\"ace/lib/event\",\"ace/lib/lang\",\"ace/lib/dom\"], function(require, exports, module) {\n\"use strict\";\n\nvar Renderer = require(\"../virtual_renderer\").VirtualRenderer;\nvar Editor = require(\"../editor\").Editor;\nvar Range = require(\"../range\").Range;\nvar event = require(\"../lib/event\");\nvar lang = require(\"../lib/lang\");\nvar dom = require(\"../lib/dom\");\n\nvar $singleLineEditor = function(el) {\n    var renderer = new Renderer(el);\n\n    renderer.$maxLines = 4;\n\n    var editor = new Editor(renderer);\n\n    editor.setHighlightActiveLine(false);\n    editor.setShowPrintMargin(false);\n    editor.renderer.setShowGutter(false);\n    editor.renderer.setHighlightGutterLine(false);\n\n    editor.$mouseHandler.$focusTimeout = 0;\n    editor.$highlightTagPending = true;\n\n    return editor;\n};\n\nvar AcePopup = function(parentNode) {\n    var el = dom.createElement(\"div\");\n    var popup = new $singleLineEditor(el);\n\n    if (parentNode)\n        parentNode.appendChild(el);\n    el.style.display = \"none\";\n    popup.renderer.content.style.cursor = \"default\";\n    popup.renderer.setStyle(\"ace_autocomplete\");\n\n    popup.setOption(\"displayIndentGuides\", false);\n    popup.setOption(\"dragDelay\", 150);\n\n    var noop = function(){};\n\n    popup.focus = noop;\n    popup.$isFocused = true;\n\n    popup.renderer.$cursorLayer.restartTimer = noop;\n    popup.renderer.$cursorLayer.element.style.opacity = 0;\n\n    popup.renderer.$maxLines = 8;\n    popup.renderer.$keepTextAreaAtCursor = false;\n\n    popup.setHighlightActiveLine(false);\n    popup.session.highlight(\"\");\n    popup.session.$searchHighlight.clazz = \"ace_highlight-marker\";\n\n    popup.on(\"mousedown\", function(e) {\n        var pos = e.getDocumentPosition();\n        popup.selection.moveToPosition(pos);\n        selectionMarker.start.row = selectionMarker.end.row = pos.row;\n        e.stop();\n    });\n\n    var lastMouseEvent;\n    var hoverMarker = new Range(-1,0,-1,Infinity);\n    var selectionMarker = new Range(-1,0,-1,Infinity);\n    selectionMarker.id = popup.session.addMarker(selectionMarker, \"ace_active-line\", \"fullLine\");\n    popup.setSelectOnHover = function(val) {\n        if (!val) {\n            hoverMarker.id = popup.session.addMarker(hoverMarker, \"ace_line-hover\", \"fullLine\");\n        } else if (hoverMarker.id) {\n            popup.session.removeMarker(hoverMarker.id);\n            hoverMarker.id = null;\n        }\n    };\n    popup.setSelectOnHover(false);\n    popup.on(\"mousemove\", function(e) {\n        if (!lastMouseEvent) {\n            lastMouseEvent = e;\n            return;\n        }\n        if (lastMouseEvent.x == e.x && lastMouseEvent.y == e.y) {\n            return;\n        }\n        lastMouseEvent = e;\n        lastMouseEvent.scrollTop = popup.renderer.scrollTop;\n        var row = lastMouseEvent.getDocumentPosition().row;\n        if (hoverMarker.start.row != row) {\n            if (!hoverMarker.id)\n                popup.setRow(row);\n            setHoverMarker(row);\n        }\n    });\n    popup.renderer.on(\"beforeRender\", function() {\n        if (lastMouseEvent && hoverMarker.start.row != -1) {\n            lastMouseEvent.$pos = null;\n            var row = lastMouseEvent.getDocumentPosition().row;\n            if (!hoverMarker.id)\n                popup.setRow(row);\n            setHoverMarker(row, true);\n        }\n    });\n    popup.renderer.on(\"afterRender\", function() {\n        var row = popup.getRow();\n        var t = popup.renderer.$textLayer;\n        var selected = t.element.childNodes[row - t.config.firstRow];\n        if (selected !== t.selectedNode && t.selectedNode)\n            dom.removeCssClass(t.selectedNode, \"ace_selected\");\n        t.selectedNode = selected;\n        if (selected)\n            dom.addCssClass(selected, \"ace_selected\");\n    });\n    var hideHoverMarker = function() { setHoverMarker(-1); };\n    var setHoverMarker = function(row, suppressRedraw) {\n        if (row !== hoverMarker.start.row) {\n            hoverMarker.start.row = hoverMarker.end.row = row;\n            if (!suppressRedraw)\n                popup.session._emit(\"changeBackMarker\");\n            popup._emit(\"changeHoverMarker\");\n        }\n    };\n    popup.getHoveredRow = function() {\n        return hoverMarker.start.row;\n    };\n\n    event.addListener(popup.container, \"mouseout\", hideHoverMarker);\n    popup.on(\"hide\", hideHoverMarker);\n    popup.on(\"changeSelection\", hideHoverMarker);\n\n    popup.session.doc.getLength = function() {\n        return popup.data.length;\n    };\n    popup.session.doc.getLine = function(i) {\n        var data = popup.data[i];\n        if (typeof data == \"string\")\n            return data;\n        return (data && data.value) || \"\";\n    };\n\n    var bgTokenizer = popup.session.bgTokenizer;\n    bgTokenizer.$tokenizeRow = function(row) {\n        var data = popup.data[row];\n        var tokens = [];\n        if (!data)\n            return tokens;\n        if (typeof data == \"string\")\n            data = {value: data};\n        var caption = data.caption || data.value || data.name;\n\n        function addToken(value, className) {\n            value && tokens.push({\n                type: (data.className || \"\") + (className || \"\"), \n                value: value\n            });\n        }\n        \n        var lower = caption.toLowerCase();\n        var filterText = (popup.filterText || \"\").toLowerCase();\n        var lastIndex = 0;\n        var lastI = 0;\n        for (var i = 0; i <= filterText.length; i++) {\n            if (i != lastI && (data.matchMask & (1 << i) || i == filterText.length)) {\n                var sub = filterText.slice(lastI, i);\n                lastI = i;\n                var index = lower.indexOf(sub, lastIndex);\n                if (index == -1) continue;\n                addToken(caption.slice(lastIndex, index), \"\");\n                lastIndex = index + sub.length;\n                addToken(caption.slice(index, lastIndex), \"completion-highlight\");\n            }\n        }\n        addToken(caption.slice(lastIndex, caption.length), \"\");\n        \n        if (data.meta)\n            tokens.push({type: \"completion-meta\", value: data.meta});\n        if (data.message)\n            tokens.push({type: \"completion-message\", value: data.message});\n\n        return tokens;\n    };\n    bgTokenizer.$updateOnChange = noop;\n    bgTokenizer.start = noop;\n\n    popup.session.$computeWidth = function() {\n        return this.screenWidth = 0;\n    };\n    popup.isOpen = false;\n    popup.isTopdown = false;\n    popup.autoSelect = true;\n    popup.filterText = \"\";\n\n    popup.data = [];\n    popup.setData = function(list, filterText) {\n        popup.filterText = filterText || \"\";\n        popup.setValue(lang.stringRepeat(\"\\n\", list.length), -1);\n        popup.data = list || [];\n        popup.setRow(0);\n    };\n    popup.getData = function(row) {\n        return popup.data[row];\n    };\n\n    popup.getRow = function() {\n        return selectionMarker.start.row;\n    };\n    popup.setRow = function(line) {\n        line = Math.max(this.autoSelect ? 0 : -1, Math.min(this.data.length, line));\n        if (selectionMarker.start.row != line) {\n            popup.selection.clearSelection();\n            selectionMarker.start.row = selectionMarker.end.row = line || 0;\n            popup.session._emit(\"changeBackMarker\");\n            popup.moveCursorTo(line || 0, 0);\n            if (popup.isOpen)\n                popup._signal(\"select\");\n        }\n    };\n\n    popup.on(\"changeSelection\", function() {\n        if (popup.isOpen)\n            popup.setRow(popup.selection.lead.row);\n        popup.renderer.scrollCursorIntoView();\n    });\n\n    popup.hide = function() {\n        this.container.style.display = \"none\";\n        this._signal(\"hide\");\n        popup.isOpen = false;\n    };\n    popup.show = function(pos, lineHeight, topdownOnly) {\n        var el = this.container;\n        var screenHeight = window.innerHeight;\n        var screenWidth = window.innerWidth;\n        var renderer = this.renderer;\n        var maxH = renderer.$maxLines * lineHeight * 1.4;\n        var top = pos.top + this.$borderSize;\n        var allowTopdown = top > screenHeight / 2 && !topdownOnly;\n        if (allowTopdown && top + lineHeight + maxH > screenHeight) {\n            renderer.$maxPixelHeight = top - 2 * this.$borderSize;\n            el.style.top = \"\";\n            el.style.bottom = screenHeight - top + \"px\";\n            popup.isTopdown = false;\n        } else {\n            top += lineHeight;\n            renderer.$maxPixelHeight = screenHeight - top - 0.2 * lineHeight;\n            el.style.top = top + \"px\";\n            el.style.bottom = \"\";\n            popup.isTopdown = true;\n        }\n\n        el.style.display = \"\";\n\n        var left = pos.left;\n        if (left + el.offsetWidth > screenWidth)\n            left = screenWidth - el.offsetWidth;\n\n        el.style.left = left + \"px\";\n\n        this._signal(\"show\");\n        lastMouseEvent = null;\n        popup.isOpen = true;\n    };\n\n    popup.goTo = function(where) {\n        var row = this.getRow();\n        var max = this.session.getLength() - 1;\n\n        switch(where) {\n            case \"up\": row = row <= 0 ? max : row - 1; break;\n            case \"down\": row = row >= max ? -1 : row + 1; break;\n            case \"start\": row = 0; break;\n            case \"end\": row = max; break;\n        }\n\n        this.setRow(row);\n    };\n\n\n    popup.getTextLeftOffset = function() {\n        return this.$borderSize + this.renderer.$padding + this.$imageSize;\n    };\n\n    popup.$imageSize = 0;\n    popup.$borderSize = 1;\n\n    return popup;\n};\n\ndom.importCssString(\"\\\n.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #CAD6FA;\\\n    z-index: 1;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_marker-layer .ace_active-line {\\\n    background-color: #3a674e;\\\n}\\\n.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid #abbffe;\\\n    margin-top: -1px;\\\n    background: rgba(233,233,253,0.4);\\\n    position: absolute;\\\n    z-index: 2;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_line-hover {\\\n    border: 1px solid rgba(109, 150, 13, 0.8);\\\n    background: rgba(58, 103, 78, 0.62);\\\n}\\\n.ace_completion-meta {\\\n    opacity: 0.5;\\\n    margin: 0.9em;\\\n}\\\n.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #2d69c7;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete .ace_completion-highlight{\\\n    color: #93ca12;\\\n}\\\n.ace_autocomplete.ace-tm .ace_marker-layer .ace_active-line {\\\n    background-color: #CAD6FA;\\\n    z-index: 1;\\\n}\\\n.ace_autocomplete.ace-tm .ace_line-hover {\\\n    border: 1px solid #abbffe;\\\n    margin-top: -1px;\\\n    background: rgba(233,233,253,0.4);\\\n}\\\n.ace_autocomplete .ace_line-hover {\\\n    position: absolute;\\\n    z-index: 2;\\\n}\\\n.ace_autocomplete .ace_scroller {\\\n    background: none;\\\n    border: none;\\\n    box-shadow: none;\\\n}\\\n.ace_rightAlignedText {\\\n    color: gray;\\\n    display: inline-block;\\\n    position: absolute;\\\n    right: 4px;\\\n    text-align: right;\\\n    z-index: -1;\\\n}\\\n.ace_completion-message {\\\n    color: blue;\\\n}\\\n.ace_autocomplete .ace_completion-highlight{\\\n    text-shadow: 0 0 0.01em;\\\n}\\\n.ace_autocomplete {\\\n    width: 280px;\\\n    z-index: 200000;\\\n    background: #fbfbfb;\\\n    color: #444;\\\n    border: 1px lightgray solid;\\\n    position: fixed;\\\n    box-shadow: 2px 3px 5px rgba(0,0,0,.2);\\\n    line-height: 1.4;\\\n    background: #fefefe;\\\n    color: #111;\\\n}\\\n.ace_dark.ace_editor.ace_autocomplete {\\\n    border: 1px #484747 solid;\\\n    box-shadow: 2px 3px 5px rgba(0, 0, 0, 0.51);\\\n    line-height: 1.4;\\\n    background: #25282c;\\\n    color: #c1c1c1;\\\n}\", \"autocompletion.css\", false);\n\nexports.AcePopup = AcePopup;\nexports.$singleLineEditor = $singleLineEditor;\n});\n\nace.define(\"ace/autocomplete/util\",[\"require\",\"exports\",\"module\"], function(require, exports, module) {\n\"use strict\";\n\nexports.parForEach = function(array, fn, callback) {\n    var completed = 0;\n    var arLength = array.length;\n    if (arLength === 0)\n        callback();\n    for (var i = 0; i < arLength; i++) {\n        fn(array[i], function(result, err) {\n            completed++;\n            if (completed === arLength)\n                callback(result, err);\n        });\n    }\n};\n\nvar ID_REGEX = /[a-zA-Z_0-9\\$\\-\\u00A2-\\u2000\\u2070-\\uFFFF]/;\n\nexports.retrievePrecedingIdentifier = function(text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n    for (var i = pos-1; i >= 0; i--) {\n        if (regex.test(text[i]))\n            buf.push(text[i]);\n        else\n            break;\n    }\n    return buf.reverse().join(\"\");\n};\n\nexports.retrieveFollowingIdentifier = function(text, pos, regex) {\n    regex = regex || ID_REGEX;\n    var buf = [];\n    for (var i = pos; i < text.length; i++) {\n        if (regex.test(text[i]))\n            buf.push(text[i]);\n        else\n            break;\n    }\n    return buf;\n};\n\nexports.getCompletionPrefix = function (editor) {\n    var pos = editor.getCursorPosition();\n    var line = editor.session.getLine(pos.row);\n    var prefix;\n    editor.completers.forEach(function(completer) {\n        if (completer.identifierRegexps) {\n            completer.identifierRegexps.forEach(function(identifierRegex) {\n                if (!prefix && identifierRegex)\n                    prefix = this.retrievePrecedingIdentifier(line, pos.column, identifierRegex);\n            }.bind(this));\n        }\n    }.bind(this));\n    return prefix || this.retrievePrecedingIdentifier(line, pos.column);\n};\n\n});\n\nace.define(\"ace/autocomplete\",[\"require\",\"exports\",\"module\",\"ace/keyboard/hash_handler\",\"ace/autocomplete/popup\",\"ace/autocomplete/util\",\"ace/lib/lang\",\"ace/lib/dom\",\"ace/snippets\",\"ace/config\"], function(require, exports, module) {\n\"use strict\";\n\nvar HashHandler = require(\"./keyboard/hash_handler\").HashHandler;\nvar AcePopup = require(\"./autocomplete/popup\").AcePopup;\nvar util = require(\"./autocomplete/util\");\nvar lang = require(\"./lib/lang\");\nvar dom = require(\"./lib/dom\");\nvar snippetManager = require(\"./snippets\").snippetManager;\nvar config = require(\"./config\");\n\nvar Autocomplete = function() {\n    this.autoInsert = false;\n    this.autoSelect = true;\n    this.exactMatch = false;\n    this.gatherCompletionsId = 0;\n    this.keyboardHandler = new HashHandler();\n    this.keyboardHandler.bindKeys(this.commands);\n\n    this.blurListener = this.blurListener.bind(this);\n    this.changeListener = this.changeListener.bind(this);\n    this.mousedownListener = this.mousedownListener.bind(this);\n    this.mousewheelListener = this.mousewheelListener.bind(this);\n\n    this.changeTimer = lang.delayedCall(function() {\n        this.updateCompletions(true);\n    }.bind(this));\n\n    this.tooltipTimer = lang.delayedCall(this.updateDocTooltip.bind(this), 50);\n};\n\n(function() {\n\n    this.$init = function() {\n        this.popup = new AcePopup(document.body || document.documentElement);\n        this.popup.on(\"click\", function(e) {\n            this.insertMatch();\n            e.stop();\n        }.bind(this));\n        this.popup.focus = this.editor.focus.bind(this.editor);\n        this.popup.on(\"show\", this.tooltipTimer.bind(null, null));\n        this.popup.on(\"select\", this.tooltipTimer.bind(null, null));\n        this.popup.on(\"changeHoverMarker\", this.tooltipTimer.bind(null, null));\n        return this.popup;\n    };\n\n    this.getPopup = function() {\n        return this.popup || this.$init();\n    };\n\n    this.openPopup = function(editor, prefix, keepPopupPosition) {\n        if (!this.popup)\n            this.$init();\n\n        this.popup.autoSelect = this.autoSelect;\n\n        this.popup.setData(this.completions.filtered, this.completions.filterText);\n\n        editor.keyBinding.addKeyboardHandler(this.keyboardHandler);\n        \n        var renderer = editor.renderer;\n        this.popup.setRow(this.autoSelect ? 0 : -1);\n        if (!keepPopupPosition) {\n            this.popup.setTheme(editor.getTheme());\n            this.popup.setFontSize(editor.getFontSize());\n\n            var lineHeight = renderer.layerConfig.lineHeight;\n\n            var pos = renderer.$cursorLayer.getPixelPosition(this.base, true);\n            pos.left -= this.popup.getTextLeftOffset();\n\n            var rect = editor.container.getBoundingClientRect();\n            pos.top += rect.top - renderer.layerConfig.offset;\n            pos.left += rect.left - editor.renderer.scrollLeft;\n            pos.left += renderer.gutterWidth;\n\n            this.popup.show(pos, lineHeight);\n        } else if (keepPopupPosition && !prefix) {\n            this.detach();\n        }\n        this.changeTimer.cancel();\n    };\n\n    this.detach = function() {\n        this.editor.keyBinding.removeKeyboardHandler(this.keyboardHandler);\n        this.editor.off(\"changeSelection\", this.changeListener);\n        this.editor.off(\"blur\", this.blurListener);\n        this.editor.off(\"mousedown\", this.mousedownListener);\n        this.editor.off(\"mousewheel\", this.mousewheelListener);\n        this.changeTimer.cancel();\n        this.hideDocTooltip();\n\n        this.gatherCompletionsId += 1;\n        if (this.popup && this.popup.isOpen)\n            this.popup.hide();\n\n        if (this.base)\n            this.base.detach();\n        this.activated = false;\n        this.completions = this.base = null;\n    };\n\n    this.changeListener = function(e) {\n        var cursor = this.editor.selection.lead;\n        if (cursor.row != this.base.row || cursor.column < this.base.column) {\n            this.detach();\n        }\n        if (this.activated)\n            this.changeTimer.schedule();\n        else\n            this.detach();\n    };\n\n    this.blurListener = function(e) {\n        var el = document.activeElement;\n        var text = this.editor.textInput.getElement();\n        var fromTooltip = e.relatedTarget && this.tooltipNode && this.tooltipNode.contains(e.relatedTarget);\n        var container = this.popup && this.popup.container;\n        if (el != text && el.parentNode != container && !fromTooltip\n            && el != this.tooltipNode && e.relatedTarget != text\n        ) {\n            this.detach();\n        }\n    };\n\n    this.mousedownListener = function(e) {\n        this.detach();\n    };\n\n    this.mousewheelListener = function(e) {\n        this.detach();\n    };\n\n    this.goTo = function(where) {\n        this.popup.goTo(where);\n    };\n\n    this.insertMatch = function(data, options) {\n        if (!data)\n            data = this.popup.getData(this.popup.getRow());\n        if (!data)\n            return false;\n\n        var completions = this.completions;\n        this.editor.startOperation({command: {name: \"insertMatch\"}});\n        if (data.completer && data.completer.insertMatch) {\n            data.completer.insertMatch(this.editor, data);\n        } else {\n            if (completions.filterText) {\n                var ranges = this.editor.selection.getAllRanges();\n                for (var i = 0, range; range = ranges[i]; i++) {\n                    range.start.column -= completions.filterText.length;\n                    this.editor.session.remove(range);\n                }\n            }\n            if (data.snippet)\n                snippetManager.insertSnippet(this.editor, data.snippet);\n            else\n                this.editor.execCommand(\"insertstring\", data.value || data);\n        }\n        if (this.completions == completions)\n            this.detach();\n        this.editor.endOperation();\n    };\n\n\n    this.commands = {\n        \"Up\": function(editor) { editor.completer.goTo(\"up\"); },\n        \"Down\": function(editor) { editor.completer.goTo(\"down\"); },\n        \"Ctrl-Up|Ctrl-Home\": function(editor) { editor.completer.goTo(\"start\"); },\n        \"Ctrl-Down|Ctrl-End\": function(editor) { editor.completer.goTo(\"end\"); },\n\n        \"Esc\": function(editor) { editor.completer.detach(); },\n        \"Return\": function(editor) { return editor.completer.insertMatch(); },\n        \"Shift-Return\": function(editor) { editor.completer.insertMatch(null, {deleteSuffix: true}); },\n        \"Tab\": function(editor) {\n            var result = editor.completer.insertMatch();\n            if (!result && !editor.tabstopManager)\n                editor.completer.goTo(\"down\");\n            else\n                return result;\n        },\n\n        \"PageUp\": function(editor) { editor.completer.popup.gotoPageUp(); },\n        \"PageDown\": function(editor) { editor.completer.popup.gotoPageDown(); }\n    };\n\n    this.gatherCompletions = function(editor, callback) {\n        var session = editor.getSession();\n        var pos = editor.getCursorPosition();\n\n        var prefix = util.getCompletionPrefix(editor);\n\n        this.base = session.doc.createAnchor(pos.row, pos.column - prefix.length);\n        this.base.$insertRight = true;\n\n        var matches = [];\n        var total = editor.completers.length;\n        editor.completers.forEach(function(completer, i) {\n            completer.getCompletions(editor, session, pos, prefix, function(err, results) {\n                if (!err && results)\n                    matches = matches.concat(results);\n                callback(null, {\n                    prefix: util.getCompletionPrefix(editor),\n                    matches: matches,\n                    finished: (--total === 0)\n                });\n            });\n        });\n        return true;\n    };\n\n    this.showPopup = function(editor, options) {\n        if (this.editor)\n            this.detach();\n\n        this.activated = true;\n\n        this.editor = editor;\n        if (editor.completer != this) {\n            if (editor.completer)\n                editor.completer.detach();\n            editor.completer = this;\n        }\n\n        editor.on(\"changeSelection\", this.changeListener);\n        editor.on(\"blur\", this.blurListener);\n        editor.on(\"mousedown\", this.mousedownListener);\n        editor.on(\"mousewheel\", this.mousewheelListener);\n\n        this.updateCompletions(false, options);\n    };\n\n    this.updateCompletions = function(keepPopupPosition, options) {\n        if (keepPopupPosition && this.base && this.completions) {\n            var pos = this.editor.getCursorPosition();\n            var prefix = this.editor.session.getTextRange({start: this.base, end: pos});\n            if (prefix == this.completions.filterText)\n                return;\n            this.completions.setFilter(prefix);\n            if (!this.completions.filtered.length)\n                return this.detach();\n            if (this.completions.filtered.length == 1\n            && this.completions.filtered[0].value == prefix\n            && !this.completions.filtered[0].snippet)\n                return this.detach();\n            this.openPopup(this.editor, prefix, keepPopupPosition);\n            return;\n        }\n        \n        if (options && options.matches) {\n            var pos = this.editor.getSelectionRange().start;\n            this.base = this.editor.session.doc.createAnchor(pos.row, pos.column);\n            this.base.$insertRight = true;\n            this.completions = new FilteredList(options.matches);\n            return this.openPopup(this.editor, \"\", keepPopupPosition);\n        }\n        var _id = this.gatherCompletionsId;\n        var detachIfFinished = function(results) {\n            if (!results.finished) return;\n            return this.detach();\n        }.bind(this);\n\n        var processResults = function(results) {\n            var prefix = results.prefix;\n            var matches = results.matches;\n\n            this.completions = new FilteredList(matches);\n\n            if (this.exactMatch)\n                this.completions.exactMatch = true;\n\n            this.completions.setFilter(prefix);\n            var filtered = this.completions.filtered;\n            if (!filtered.length)\n                return detachIfFinished(results);\n            if (filtered.length == 1 && filtered[0].value == prefix && !filtered[0].snippet)\n                return detachIfFinished(results);\n            if (this.autoInsert && filtered.length == 1 && results.finished)\n                return this.insertMatch(filtered[0]);\n\n            this.openPopup(this.editor, prefix, keepPopupPosition);\n        }.bind(this);\n\n        var isImmediate = true;\n        var immediateResults = null;\n        this.gatherCompletions(this.editor, function(err, results) {\n            var prefix = results.prefix;\n            var matches = results && results.matches;\n\n            if (!matches || !matches.length)\n                return detachIfFinished(results);\n            if (prefix.indexOf(results.prefix) !== 0 || _id != this.gatherCompletionsId)\n                return;\n            if (isImmediate) {\n                immediateResults = results;\n                return;\n            }\n\n            processResults(results);\n        }.bind(this));\n        \n        isImmediate = false;\n        if (immediateResults) {\n            var results = immediateResults;\n            immediateResults = null;\n            processResults(results);\n        }\n    };\n\n    this.cancelContextMenu = function() {\n        this.editor.$mouseHandler.cancelContextMenu();\n    };\n\n    this.updateDocTooltip = function() {\n        var popup = this.popup;\n        var all = popup.data;\n        var selected = all && (all[popup.getHoveredRow()] || all[popup.getRow()]);\n        var doc = null;\n        if (!selected || !this.editor || !this.popup.isOpen)\n            return this.hideDocTooltip();\n        this.editor.completers.some(function(completer) {\n            if (completer.getDocTooltip)\n                doc = completer.getDocTooltip(selected);\n            return doc;\n        });\n        if (!doc && typeof selected != \"string\")\n            doc = selected;\n\n        if (typeof doc == \"string\")\n            doc = {docText: doc};\n        if (!doc || !(doc.docHTML || doc.docText))\n            return this.hideDocTooltip();\n        this.showDocTooltip(doc);\n    };\n\n    this.showDocTooltip = function(item) {\n        if (!this.tooltipNode) {\n            this.tooltipNode = dom.createElement(\"div\");\n            this.tooltipNode.className = \"ace_tooltip ace_doc-tooltip\";\n            this.tooltipNode.style.margin = 0;\n            this.tooltipNode.style.pointerEvents = \"auto\";\n            this.tooltipNode.tabIndex = -1;\n            this.tooltipNode.onblur = this.blurListener.bind(this);\n            this.tooltipNode.onclick = this.onTooltipClick.bind(this);\n        }\n\n        var tooltipNode = this.tooltipNode;\n        if (item.docHTML) {\n            tooltipNode.innerHTML = item.docHTML;\n        } else if (item.docText) {\n            tooltipNode.textContent = item.docText;\n        }\n\n        if (!tooltipNode.parentNode)\n            document.body.appendChild(tooltipNode);\n        var popup = this.popup;\n        var rect = popup.container.getBoundingClientRect();\n        tooltipNode.style.top = popup.container.style.top;\n        tooltipNode.style.bottom = popup.container.style.bottom;\n\n        tooltipNode.style.display = \"block\";\n        if (window.innerWidth - rect.right < 320) {\n            if (rect.left < 320) {\n                if(popup.isTopdown) {\n                    tooltipNode.style.top = rect.bottom + \"px\";\n                    tooltipNode.style.left = rect.left + \"px\";\n                    tooltipNode.style.right = \"\";\n                    tooltipNode.style.bottom = \"\";\n                } else {\n                    tooltipNode.style.top = popup.container.offsetTop - tooltipNode.offsetHeight + \"px\";\n                    tooltipNode.style.left = rect.left + \"px\";\n                    tooltipNode.style.right = \"\";\n                    tooltipNode.style.bottom = \"\";\n                }\n            } else {\n                tooltipNode.style.right = window.innerWidth - rect.left + \"px\";\n                tooltipNode.style.left = \"\";\n            }\n        } else {\n            tooltipNode.style.left = (rect.right + 1) + \"px\";\n            tooltipNode.style.right = \"\";\n        }\n    };\n\n    this.hideDocTooltip = function() {\n        this.tooltipTimer.cancel();\n        if (!this.tooltipNode) return;\n        var el = this.tooltipNode;\n        if (!this.editor.isFocused() && document.activeElement == el)\n            this.editor.focus();\n        this.tooltipNode = null;\n        if (el.parentNode)\n            el.parentNode.removeChild(el);\n    };\n    \n    this.onTooltipClick = function(e) {\n        var a = e.target;\n        while (a && a != this.tooltipNode) {\n            if (a.nodeName == \"A\" && a.href) {\n                a.rel = \"noreferrer\";\n                a.target = \"_blank\";\n                break;\n            }\n            a = a.parentNode;\n        }\n    };\n\n    this.destroy = function() {\n        this.detach();\n        if (this.popup) {\n            this.popup.destroy();\n            var el = this.popup.container;\n            if (el && el.parentNode)\n                el.parentNode.removeChild(el);\n        }\n        if (this.editor && this.editor.completer == this)\n            this.editor.completer == null;\n        this.popup = null;\n    };\n\n}).call(Autocomplete.prototype);\n\n\nAutocomplete.for = function(editor) {\n    if (editor.completer) {\n        return editor.completer;\n    }\n    if (config.get(\"sharedPopups\")) {\n        if (!Autocomplete.$shared)\n            Autocomplete.$sharedInstance = new Autocomplete();\n        editor.completer = Autocomplete.$sharedInstance;\n    } else {\n        editor.completer = new Autocomplete();\n        editor.once(\"destroy\", function(e, editor) {\n            editor.completer.destroy();\n        });\n    }\n    return editor.completer;\n};\n\nAutocomplete.startCommand = {\n    name: \"startAutocomplete\",\n    exec: function(editor, options) {\n        var completer = Autocomplete.for(editor);\n        completer.autoInsert = false;\n        completer.autoSelect = true;\n        completer.showPopup(editor, options);\n        completer.cancelContextMenu();\n    },\n    bindKey: \"Ctrl-Space|Ctrl-Shift-Space|Alt-Space\"\n};\n\nvar FilteredList = function(array, filterText) {\n    this.all = array;\n    this.filtered = array;\n    this.filterText = filterText || \"\";\n    this.exactMatch = false;\n};\n(function(){\n    this.setFilter = function(str) {\n        if (str.length > this.filterText && str.lastIndexOf(this.filterText, 0) === 0)\n            var matches = this.filtered;\n        else\n            var matches = this.all;\n\n        this.filterText = str;\n        matches = this.filterCompletions(matches, this.filterText);\n        matches = matches.sort(function(a, b) {\n            return b.exactMatch - a.exactMatch || b.$score - a.$score \n                || (a.caption || a.value).localeCompare(b.caption || b.value);\n        });\n        var prev = null;\n        matches = matches.filter(function(item){\n            var caption = item.snippet || item.caption || item.value;\n            if (caption === prev) return false;\n            prev = caption;\n            return true;\n        });\n\n        this.filtered = matches;\n    };\n    this.filterCompletions = function(items, needle) {\n        var results = [];\n        var upper = needle.toUpperCase();\n        var lower = needle.toLowerCase();\n        loop: for (var i = 0, item; item = items[i]; i++) {\n            var caption = item.caption || item.value || item.snippet;\n            if (!caption) continue;\n            var lastIndex = -1;\n            var matchMask = 0;\n            var penalty = 0;\n            var index, distance;\n\n            if (this.exactMatch) {\n                if (needle !== caption.substr(0, needle.length))\n                    continue loop;\n            } else {\n                var fullMatchIndex = caption.toLowerCase().indexOf(lower);\n                if (fullMatchIndex > -1) {\n                    penalty = fullMatchIndex;\n                } else {\n                    for (var j = 0; j < needle.length; j++) {\n                        var i1 = caption.indexOf(lower[j], lastIndex + 1);\n                        var i2 = caption.indexOf(upper[j], lastIndex + 1);\n                        index = (i1 >= 0) ? ((i2 < 0 || i1 < i2) ? i1 : i2) : i2;\n                        if (index < 0)\n                            continue loop;\n                        distance = index - lastIndex - 1;\n                        if (distance > 0) {\n                            if (lastIndex === -1)\n                                penalty += 10;\n                            penalty += distance;\n                            matchMask = matchMask | (1 << j);\n                        }\n                        lastIndex = index;\n                    }\n                }\n            }\n            item.matchMask = matchMask;\n            item.exactMatch = penalty ? 0 : 1;\n            item.$score = (item.score || 0) - penalty;\n            results.push(item);\n        }\n        return results;\n    };\n}).call(FilteredList.prototype);\n\nexports.Autocomplete = Autocomplete;\nexports.FilteredList = FilteredList;\n\n});\n\nace.define(\"ace/autocomplete/text_completer\",[\"require\",\"exports\",\"module\",\"ace/range\"], function(require, exports, module) {\n    var Range = require(\"../range\").Range;\n    \n    var splitRegex = /[^a-zA-Z_0-9\\$\\-\\u00C0-\\u1FFF\\u2C00-\\uD7FF\\w]+/;\n\n    function getWordIndex(doc, pos) {\n        var textBefore = doc.getTextRange(Range.fromPoints({row: 0, column:0}, pos));\n        return textBefore.split(splitRegex).length - 1;\n    }\n    function wordDistance(doc, pos) {\n        var prefixPos = getWordIndex(doc, pos);\n        var words = doc.getValue().split(splitRegex);\n        var wordScores = Object.create(null);\n        \n        var currentWord = words[prefixPos];\n\n        words.forEach(function(word, idx) {\n            if (!word || word === currentWord) return;\n\n            var distance = Math.abs(prefixPos - idx);\n            var score = words.length - distance;\n            if (wordScores[word]) {\n                wordScores[word] = Math.max(score, wordScores[word]);\n            } else {\n                wordScores[word] = score;\n            }\n        });\n        return wordScores;\n    }\n\n    exports.getCompletions = function(editor, session, pos, prefix, callback) {\n        var wordScore = wordDistance(session, pos);\n        var wordList = Object.keys(wordScore);\n        callback(null, wordList.map(function(word) {\n            return {\n                caption: word,\n                value: word,\n                score: wordScore[word],\n                meta: \"local\"\n            };\n        }));\n    };\n});\n\nace.define(\"ace/ext/language_tools\",[\"require\",\"exports\",\"module\",\"ace/snippets\",\"ace/autocomplete\",\"ace/config\",\"ace/lib/lang\",\"ace/autocomplete/util\",\"ace/autocomplete/text_completer\",\"ace/editor\",\"ace/config\"], function(require, exports, module) {\n\"use strict\";\n\nvar snippetManager = require(\"../snippets\").snippetManager;\nvar Autocomplete = require(\"../autocomplete\").Autocomplete;\nvar config = require(\"../config\");\nvar lang = require(\"../lib/lang\");\nvar util = require(\"../autocomplete/util\");\n\nvar textCompleter = require(\"../autocomplete/text_completer\");\nvar keyWordCompleter = {\n    getCompletions: function(editor, session, pos, prefix, callback) {\n        if (session.$mode.completer) {\n            return session.$mode.completer.getCompletions(editor, session, pos, prefix, callback);\n        }\n        var state = editor.session.getState(pos.row);\n        var completions = session.$mode.getCompletions(state, session, pos, prefix);\n        callback(null, completions);\n    }\n};\n\nvar transformSnippetTooltip = function(str) {\n    var record = {};\n    return str.replace(/\\${(\\d+)(:(.*?))?}/g, function(_, p1, p2, p3) {\n        return (record[p1] = p3 || '');\n    }).replace(/\\$(\\d+?)/g, function (_, p1) {\n        return record[p1];\n    });\n};\n\nvar snippetCompleter = {\n    getCompletions: function(editor, session, pos, prefix, callback) {\n        var scopes = [];\n        var token = session.getTokenAt(pos.row, pos.column);\n        if (token && token.type.match(/(tag-name|tag-open|tag-whitespace|attribute-name|attribute-value)\\.xml$/))\n            scopes.push('html-tag');\n        else\n            scopes = snippetManager.getActiveScopes(editor);\n\n        var snippetMap = snippetManager.snippetMap;\n        var completions = [];\n        scopes.forEach(function(scope) {\n            var snippets = snippetMap[scope] || [];\n            for (var i = snippets.length; i--;) {\n                var s = snippets[i];\n                var caption = s.name || s.tabTrigger;\n                if (!caption)\n                    continue;\n                completions.push({\n                    caption: caption,\n                    snippet: s.content,\n                    meta: s.tabTrigger && !s.name ? s.tabTrigger + \"\\u21E5 \" : \"snippet\",\n                    type: \"snippet\"\n                });\n            }\n        }, this);\n        callback(null, completions);\n    },\n    getDocTooltip: function(item) {\n        if (item.type == \"snippet\" && !item.docHTML) {\n            item.docHTML = [\n                \"<b>\", lang.escapeHTML(item.caption), \"</b>\", \"<hr></hr>\",\n                lang.escapeHTML(transformSnippetTooltip(item.snippet))\n            ].join(\"\");\n        }\n    }\n};\n\nvar completers = [snippetCompleter, textCompleter, keyWordCompleter];\nexports.setCompleters = function(val) {\n    completers.length = 0;\n    if (val) completers.push.apply(completers, val);\n};\nexports.addCompleter = function(completer) {\n    completers.push(completer);\n};\nexports.textCompleter = textCompleter;\nexports.keyWordCompleter = keyWordCompleter;\nexports.snippetCompleter = snippetCompleter;\n\nvar expandSnippet = {\n    name: \"expandSnippet\",\n    exec: function(editor) {\n        return snippetManager.expandWithTab(editor);\n    },\n    bindKey: \"Tab\"\n};\n\nvar onChangeMode = function(e, editor) {\n    loadSnippetsForMode(editor.session.$mode);\n};\n\nvar loadSnippetsForMode = function(mode) {\n    if (typeof mode == \"string\")\n        mode = config.$modes[mode];\n    if (!mode)\n        return;\n    if (!snippetManager.files)\n        snippetManager.files = {};\n    \n    loadSnippetFile(mode.$id, mode.snippetFileId);\n    if (mode.modes)\n        mode.modes.forEach(loadSnippetsForMode);\n};\n\nvar loadSnippetFile = function(id, snippetFilePath) {\n    if (!snippetFilePath || !id || snippetManager.files[id])\n        return;\n    snippetManager.files[id] = {};\n    config.loadModule(snippetFilePath, function(m) {\n        if (!m) return;\n        snippetManager.files[id] = m;\n        if (!m.snippets && m.snippetText)\n            m.snippets = snippetManager.parseSnippetFile(m.snippetText);\n        snippetManager.register(m.snippets || [], m.scope);\n        if (m.includeScopes) {\n            snippetManager.snippetMap[m.scope].includeScopes = m.includeScopes;\n            m.includeScopes.forEach(function(x) {\n                loadSnippetsForMode(\"ace/mode/\" + x);\n            });\n        }\n    });\n};\n\nvar doLiveAutocomplete = function(e) {\n    var editor = e.editor;\n    var hasCompleter = editor.completer && editor.completer.activated;\n    if (e.command.name === \"backspace\") {\n        if (hasCompleter && !util.getCompletionPrefix(editor))\n            editor.completer.detach();\n    }\n    else if (e.command.name === \"insertstring\") {\n        var prefix = util.getCompletionPrefix(editor);\n        if (prefix && !hasCompleter) {\n            var completer = Autocomplete.for(editor);\n            completer.autoInsert = false;\n            completer.showPopup(editor);\n        }\n    }\n};\n\nvar Editor = require(\"../editor\").Editor;\nrequire(\"../config\").defineOptions(Editor.prototype, \"editor\", {\n    enableBasicAutocompletion: {\n        set: function(val) {\n            if (val) {\n                if (!this.completers)\n                    this.completers = Array.isArray(val)? val: completers;\n                this.commands.addCommand(Autocomplete.startCommand);\n            } else {\n                this.commands.removeCommand(Autocomplete.startCommand);\n            }\n        },\n        value: false\n    },\n    enableLiveAutocompletion: {\n        set: function(val) {\n            if (val) {\n                if (!this.completers)\n                    this.completers = Array.isArray(val)? val: completers;\n                this.commands.on('afterExec', doLiveAutocomplete);\n            } else {\n                this.commands.removeListener('afterExec', doLiveAutocomplete);\n            }\n        },\n        value: false\n    },\n    enableSnippets: {\n        set: function(val) {\n            if (val) {\n                this.commands.addCommand(expandSnippet);\n                this.on(\"changeMode\", onChangeMode);\n                onChangeMode(null, this);\n            } else {\n                this.commands.removeCommand(expandSnippet);\n                this.off(\"changeMode\", onChangeMode);\n            }\n        },\n        value: false\n    }\n});\n});                (function() {\n                    ace.require([\"ace/ext/language_tools\"], function(m) {\n                        if (typeof module == \"object\" && typeof exports == \"object\" && module) {\n                            module.exports = m;\n                        }\n                    });\n                })();\n            "],"mappings":"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"},"metadata":{},"sourceType":"script"}